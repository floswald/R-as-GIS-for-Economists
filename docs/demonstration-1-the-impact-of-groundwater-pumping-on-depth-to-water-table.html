<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.1 Demonstration 1: The impact of groundwater pumping on depth to water table | R as GIS for Economists</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="1.1 Demonstration 1: The impact of groundwater pumping on depth to water table | R as GIS for Economists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.1 Demonstration 1: The impact of groundwater pumping on depth to water table | R as GIS for Economists" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Taro Mieno" />


<meta name="date" content="2020-05-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="demonstration-2-precision-agriculture.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R as GIS for Economists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="why-r-as-gis-for-economists.html"><a href="why-r-as-gis-for-economists.html"><i class="fa fa-check"></i>Why R as GIS for Economists?</a><ul>
<li class="chapter" data-level="" data-path="why-r-as-gis-for-economists.html"><a href="why-r-as-gis-for-economists.html#r-vs-python"><i class="fa fa-check"></i>R vs Python</a></li>
<li class="chapter" data-level="" data-path="why-r-as-gis-for-economists.html"><a href="why-r-as-gis-for-economists.html#r-vs-arcgis-or-qgis"><i class="fa fa-check"></i>R vs ArcGIS or QGIS</a></li>
<li class="chapter" data-level="" data-path="why-r-as-gis-for-economists.html"><a href="why-r-as-gis-for-economists.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-is-this-book-different-from-other-online-books-and-resources.html"><a href="how-is-this-book-different-from-other-online-books-and-resources.html"><i class="fa fa-check"></i>How is this book different from other online books and resources?</a></li>
<li class="chapter" data-level="" data-path="what-is-going-to-be-covered-in-this-book.html"><a href="what-is-going-to-be-covered-in-this-book.html"><i class="fa fa-check"></i>What is going to be covered in this book?</a></li>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html"><i class="fa fa-check"></i>Conventions of the book and some notes</a><ul>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html#texts-in-gray-boxes"><i class="fa fa-check"></i>Texts in gray boxes</a></li>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html#colored-boxes"><i class="fa fa-check"></i>Colored Boxes</a></li>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html#parentheses-around-codes"><i class="fa fa-check"></i>Parentheses around codes</a></li>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html#footnotes"><i class="fa fa-check"></i>Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="session-information.html"><a href="session-information.html"><i class="fa fa-check"></i>Session Information</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="demo.html"><a href="demo.html"><i class="fa fa-check"></i><b>1</b> R as GIS: Demonstrations</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#target-audience"><i class="fa fa-check"></i>Target Audience</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#direction-for-replication"><i class="fa fa-check"></i>Direction for replication</a></li>
</ul></li>
<li class="chapter" data-level="1.1" data-path="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table.html"><a href="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table.html"><i class="fa fa-check"></i><b>1.1</b> Demonstration 1: The impact of groundwater pumping on depth to water table</a><ul>
<li class="chapter" data-level="1.1.1" data-path="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table.html"><a href="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table.html#project-overview"><i class="fa fa-check"></i><b>1.1.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.1.2" data-path="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table.html"><a href="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table.html#project-demonstration"><i class="fa fa-check"></i><b>1.1.2</b> Project Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="demonstration-2-precision-agriculture.html"><a href="demonstration-2-precision-agriculture.html"><i class="fa fa-check"></i><b>1.2</b> Demonstration 2: Precision Agriculture</a><ul>
<li class="chapter" data-level="1.2.1" data-path="demonstration-2-precision-agriculture.html"><a href="demonstration-2-precision-agriculture.html#project-overview-1"><i class="fa fa-check"></i><b>1.2.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.2.2" data-path="demonstration-2-precision-agriculture.html"><a href="demonstration-2-precision-agriculture.html#project-demonstration-1"><i class="fa fa-check"></i><b>1.2.2</b> Project Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="demonstration-3-land-use-and-weather.html"><a href="demonstration-3-land-use-and-weather.html"><i class="fa fa-check"></i><b>1.3</b> Demonstration 3: Land Use and Weather</a><ul>
<li class="chapter" data-level="1.3.1" data-path="demonstration-3-land-use-and-weather.html"><a href="demonstration-3-land-use-and-weather.html#project-overview-2"><i class="fa fa-check"></i><b>1.3.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.3.2" data-path="demonstration-3-land-use-and-weather.html"><a href="demonstration-3-land-use-and-weather.html#project-demonstration-2"><i class="fa fa-check"></i><b>1.3.2</b> Project Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="demonstration-4-the-impact-of-railroad-presence-on-corn-planted-acreage.html"><a href="demonstration-4-the-impact-of-railroad-presence-on-corn-planted-acreage.html"><i class="fa fa-check"></i><b>1.4</b> Demonstration 4: The Impact of Railroad Presence on Corn Planted Acreage</a><ul>
<li class="chapter" data-level="1.4.1" data-path="demonstration-4-the-impact-of-railroad-presence-on-corn-planted-acreage.html"><a href="demonstration-4-the-impact-of-railroad-presence-on-corn-planted-acreage.html#project-overview-3"><i class="fa fa-check"></i><b>1.4.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.4.2" data-path="demonstration-4-the-impact-of-railroad-presence-on-corn-planted-acreage.html"><a href="demonstration-4-the-impact-of-railroad-presence-on-corn-planted-acreage.html#project-demonstration-3"><i class="fa fa-check"></i><b>1.4.2</b> Project Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="demonstration-5-groundwater-use-for-agricultural-irrigation.html"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html"><i class="fa fa-check"></i><b>1.5</b> Demonstration 5: Groundwater use for agricultural irrigation</a><ul>
<li class="chapter" data-level="1.5.1" data-path="demonstration-5-groundwater-use-for-agricultural-irrigation.html"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#project-overview-4"><i class="fa fa-check"></i><b>1.5.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.5.2" data-path="demonstration-5-groundwater-use-for-agricultural-irrigation.html"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#project-demonstration-4"><i class="fa fa-check"></i><b>1.5.2</b> Project Demonstration</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R as GIS for Economists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<link href="style.css" rel="stylesheet" type="text/css">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-59758608-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-59758608-3');
</script>
<div id="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table" class="section level2">
<h2><span class="header-section-number">1.1</span> Demonstration 1: The impact of groundwater pumping on depth to water table</h2>
<!-- this is for making stargazer table nicer -->
<style>
.book .book-body .page-wrapper .page-inner section.normal table
{
  width:auto;
}
.book .book-body .page-wrapper .page-inner section.normal table td,
.book .book-body .page-wrapper .page-inner section.normal table th,
.book .book-body .page-wrapper .page-inner section.normal table tr
{
  padding:0;
  border:0;
  background-color:#fff;
}
</style>
<div id="project-overview" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Project Overview</h3>
<hr />
<p><strong>Objective:</strong></p>
<ul>
<li>Understand the impact of groundwater pumping on groundwater level.</li>
</ul>
<hr />
<p><strong>Datasets</strong></p>
<ul>
<li>Groundwater pumping by irrigation wells in Chase, Dundy, and Perkins Counties in the southwest corner of Nebraska</li>
<li>Groundwater levels observed at USGS monitoring wells located in the three counties and retrieved from the National Water Information System (NWIS) maintained by USGS using the <code>dataRetrieval</code> package.</li>
</ul>
<hr />
<p><strong>Econometric Model</strong></p>
<p>In order to achieve the project objective, we will estimate the following model:</p>
<p><span class="math display">\[
 y_{i,t} - y_{i,t-1} = \alpha + \beta gw_{i,t-1} + v
\]</span></p>
<p>where <span class="math inline">\(y_{i,t}\)</span> is the depth to groundwater table<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a> in March<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a> in year <span class="math inline">\(t\)</span> at USGS monitoring well <span class="math inline">\(i\)</span>, and <span class="math inline">\(gw_{i,t-1}\)</span> is the total amount of groundwater pumping that happened within the 2-mile radius of the monitoring well <span class="math inline">\(i\)</span>.</p>
<hr />
<p><strong>GIS tasks</strong></p>
<ul>
<li>read an ESRI shape file as an <code>sf</code> (spatial) object
<ul>
<li>use <code>sf::st_read()</code></li>
</ul></li>
<li>download depth to water table data using the <code>dataRetrieval</code> package developed by USGS
<ul>
<li>use <code>dataRetrieval::readNWISdata()</code> and <code>dataRetrieval::readNWISsite()</code></li>
</ul></li>
<li>create a buffer around USGS monitoring wells
<ul>
<li>use <code>sf::st_buffer()</code></li>
</ul></li>
<li>convert a regular <code>data.frame</code> (non-spatial) with geographic coordinates into an <code>sf</code> (spatial) objects
<ul>
<li>use <code>sf::st_as_sf()</code> and <code>sf::st_set_crs()</code></li>
</ul></li>
<li>reproject an <code>sf</code> object to another CRS
<ul>
<li>use <code>sf::st_transform()</code></li>
</ul></li>
<li>identify irrigation wells located inside the buffers and calculate total pumping
<ul>
<li>use <code>sf::st_join()</code></li>
</ul></li>
</ul>
<hr />
<p><strong>packages</strong></p>
<ul>
<li>Load (install first if you have not) the following packages if you intend to replicate the demonstration.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw">library</span>(lubridate)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw">library</span>(stargazer)</a></code></pre></div>
<p>There are other packages that will be loaded during the demonstration.</p>
</div>
<div id="project-demonstration" class="section level3">
<h3><span class="header-section-number">1.1.2</span> Project Demonstration</h3>
<p>The geographic focus of the project is the southwest corner of Nebraska consisting of Chase, Dundy, and Perkins County (see Figure <a href="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table.html#fig:NE-county">1.1</a> for their locations within Nebraska). Let’s read a shape file of the three counties represented as polygons. We will use it later to spatially filter groundwater level data downloaded from NWIS.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">three_counties &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="dt">dsn =</span> <span class="st">&quot;./Data&quot;</span>, <span class="dt">layer =</span> <span class="st">&quot;urnrd&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="co">#--- project to WGS84/UTM 14N ---#</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span><span class="kw">st_transform</span>(<span class="dv">32614</span>)</a></code></pre></div>
<pre><code>Reading layer `urnrd&#39; from data source `/Users/tmieno2/Dropbox/TeachingUNL/RGIS_Econ/Data&#39; using driver `ESRI Shapefile&#39;
Simple feature collection with 3 features and 1 field
geometry type:  POLYGON
dimension:      XY
bbox:           xmin: -102.0518 ymin: 40.00257 xmax: -101.248 ymax: 41.00395
CRS:            4269</code></pre>
<div class="figure"><span id="fig:NE-county"></span>
<img src="Demonstration_files/figure-html/NE-county-1.png" alt="The location of Chase, Dundy, and Perkins County in Nebraska" width="672" />
<p class="caption">
Figure 1.1: The location of Chase, Dundy, and Perkins County in Nebraska
</p>
</div>
<hr />
<p>We have already collected groundwater pumping data, so let’s import it.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">#--- groundwater pumping data ---#</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">(</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">urnrd_gw &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;./Data/urnrd_gw_pumping.rds&quot;</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">)</a></code></pre></div>
<pre><code>       well_id year  vol_af      lon     lat
    1:    1706 2007 182.566 245322.3 4542717
    2:    2116 2007  46.328 245620.9 4541125
    3:    2583 2007  38.380 245660.9 4542523
    4:    2597 2007  70.133 244816.2 4541143
    5:    3143 2007 135.870 243614.0 4541579
   ---                                      
18668:    2006 2012 148.713 284782.5 4432317
18669:    2538 2012 115.567 284462.6 4432331
18670:    2834 2012  15.766 283338.0 4431341
18671:    2834 2012 381.622 283740.4 4431329
18672:    4983 2012      NA 284636.0 4432725</code></pre>
<p><code>well_id</code> is the unique irrigation well identifier, and <code>vol_af</code> is the amount of groundwater pumped in acre-feet. This dataset is just a regular <code>data.frame</code> with coordinates. We need to convert this dataset into a object of class <code>sf</code> so that we can later identify irrigation wells located within a 2-mile radius of USGS monitoring wells (see Figure <a href="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table.html#fig:sp-dist-wells">1.2</a> for the spatial distribution of the irrigation wells).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">urnrd_gw_sf &lt;-<span class="st"> </span>urnrd_gw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="co">#--- convert to sf ---#</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="st">  </span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="st">  </span><span class="co">#--- set CRS WGS UTM 14 (you need to know the CRS of the coordinates to do this) ---# </span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="st">  </span><span class="kw">st_set_crs</span>(<span class="dv">32614</span>) </a>
<a class="sourceLine" id="cb14-6" data-line-number="6"></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#--- now sf ---#</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8">urnrd_gw_sf</a></code></pre></div>
<pre><code>Simple feature collection with 18672 features and 3 fields
geometry type:  POINT
dimension:      XY
bbox:           xmin: 239959 ymin: 4431329 xmax: 310414.4 ymax: 4543146
CRS:            EPSG:32614
First 10 features:
   well_id year  vol_af                 geometry
1     1706 2007 182.566 POINT (245322.3 4542717)
2     2116 2007  46.328 POINT (245620.9 4541125)
3     2583 2007  38.380 POINT (245660.9 4542523)
4     2597 2007  70.133 POINT (244816.2 4541143)
5     3143 2007 135.870   POINT (243614 4541579)
6     5017 2007 196.799 POINT (243539.9 4543146)
7     1706 2008 171.250 POINT (245322.3 4542717)
8     2116 2008 171.650 POINT (245620.9 4541125)
9     2583 2008  46.100 POINT (245660.9 4542523)
10    2597 2008 124.830 POINT (244816.2 4541143)</code></pre>
<div class="figure"><span id="fig:sp-dist-wells"></span>
<img src="Demonstration_files/figure-html/sp-dist-wells-1.png" alt="Spatial distribution of irrigation wells" width="672" />
<p class="caption">
Figure 1.2: Spatial distribution of irrigation wells
</p>
</div>
<hr />
<p>Here are the rest of the steps we will take to obtain a regression-ready dataset for our analysis.</p>
<ol style="list-style-type: decimal">
<li>download groundwater level data observed at USGS monitoring wells from National Water Information System (NWIS) using the <code>dataRetrieval</code> package</li>
<li>identify the irrigation wells located within the 2-mile radius of the USGS wells and calculate the total groundwater pumping that occurred around each of the USGS wells by year</li>
<li>merge the groundwater pumping data to the groundwater level data</li>
</ol>
<hr />
<p>Let’s download groundwater level data from NWIS first. The following code downloads groundwater level data for Nebraska from Jan 1, 1990, through Jan 1, 2016.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co">#--- load the dataRetrieval package ---#</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw">library</span>(dataRetrieval)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">#--- download groundwater level data ---#</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">NE_gwl &lt;-<span class="st"> </span><span class="kw">readNWISdata</span>(</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">    <span class="dt">stateCd=</span><span class="st">&quot;Nebraska&quot;</span>, </a>
<a class="sourceLine" id="cb16-7" data-line-number="7">    <span class="dt">startDate =</span> <span class="st">&quot;1990-01-01&quot;</span>, </a>
<a class="sourceLine" id="cb16-8" data-line-number="8">    <span class="dt">endDate =</span> <span class="st">&quot;2016-01-01&quot;</span>, </a>
<a class="sourceLine" id="cb16-9" data-line-number="9">    <span class="dt">service =</span> <span class="st">&quot;gwlevels&quot;</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(site_no, lev_dt, lev_va) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">date =</span> lev_dt, <span class="dt">dwt =</span> lev_va) </a>
<a class="sourceLine" id="cb16-13" data-line-number="13"></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="co">#--- take a look ---#</span></a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="kw">head</span>(NE_gwl, <span class="dv">10</span>)</a></code></pre></div>
<pre><code>           site_no       date   dwt
1  400008097545301 2000-11-08 17.40
2  400008097545301 2008-10-09 13.99
3  400008097545301 2009-04-09 11.32
4  400008097545301 2009-10-06 15.54
5  400008097545301 2010-04-12 11.15
6  400008100050501 1990-03-15 24.80
7  400008100050501 1990-10-04 27.20
8  400008100050501 1991-03-08 24.20
9  400008100050501 1991-10-07 26.90
10 400008100050501 1992-03-02 24.70</code></pre>
<p><code>site_no</code> is the unique monitoring well identifier, <code>date</code> is the date of groundwater level monitoring, and <code>dwt</code> is depth to water table.</p>
<p>We calculate the average groundwater level in March by USGS monitoring well (right before the irrigation season starts):<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co">#--- Average depth to water table in March ---#</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">NE_gwl_march &lt;-<span class="st"> </span>NE_gwl <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">    <span class="dt">date =</span> <span class="kw">as.Date</span>(date),</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">    <span class="dt">month =</span> <span class="kw">month</span>(date),</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">    <span class="dt">year =</span> <span class="kw">year</span>(date),</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="st">  </span><span class="co">#--- select observation in March ---#</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2007</span>, month <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="st">  </span><span class="co">#--- gwl average in March ---#</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="st">  </span><span class="kw">group_by</span>(site_no, year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">dwt  =</span> <span class="kw">mean</span>(dwt))</a>
<a class="sourceLine" id="cb18-13" data-line-number="13"></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="co">#--- take a look ---#</span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="kw">head</span>(NE_gwl_march, <span class="dv">10</span>)</a></code></pre></div>
<pre><code># A tibble: 10 x 3
# Groups:   site_no [2]
   site_no          year   dwt
   &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt;
 1 400032101022901  2008 118. 
 2 400032101022901  2009 117. 
 3 400032101022901  2010 118. 
 4 400032101022901  2011 118. 
 5 400032101022901  2012 118. 
 6 400032101022901  2013 118. 
 7 400032101022901  2014 116. 
 8 400032101022901  2015 117. 
 9 400038099244601  2007  24.3
10 400038099244601  2008  21.7</code></pre>
<p>Since <code>NE_gwl</code> is missing geographic coordinates for the monitoring wells, we will download them using the <code>readNWISsite()</code> function and select only the monitoring wells that are inside the three counties.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co">#--- get the list of site ids ---#  </span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">NE_site_ls &lt;-<span class="st"> </span>NE_gwl<span class="op">$</span>site_no <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unique</span>()</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#--- get the locations of the site ids ---#  </span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5">sites_info &lt;-<span class="st"> </span><span class="kw">readNWISsite</span>(<span class="dt">siteNumbers =</span> NE_site_ls) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(site_no, dec_lat_va, dec_long_va) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="st">  </span><span class="co">#--- turn the data into an sf object ---#</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="st">  </span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;dec_long_va&quot;</span>, <span class="st">&quot;dec_lat_va&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="st">  </span><span class="co">#--- NAD 83 ---#</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="st">  </span><span class="kw">st_set_crs</span>(<span class="dv">4269</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="st">  </span><span class="co">#--- project to WGS UTM 14 ---#</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="st">  </span><span class="kw">st_transform</span>(<span class="dv">32614</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="st">  </span><span class="co">#--- keep only those located inside the three counties ---#</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="st">  </span>.[three_counties, ]</a></code></pre></div>
<hr />
<p>We now identify irrigation wells that are located within the 2-mile radius of the monitoring wells<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>. We first create polygons of 2-mile radius circles around the monitoring wells (see Figure <a href="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table.html#fig:buffer-map">1.3</a>).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">buffers &lt;-<span class="st"> </span><span class="kw">st_buffer</span>(sites_info, <span class="dt">dist =</span> <span class="dv">2</span><span class="op">*</span><span class="fl">1609.34</span>) <span class="co"># in meter</span></a></code></pre></div>
<div class="figure"><span id="fig:buffer-map"></span>
<img src="Demonstration_files/figure-html/buffer-map-1.png" alt="2-mile buffers around USGS monitoring wells" width="672" />
<p class="caption">
Figure 1.3: 2-mile buffers around USGS monitoring wells
</p>
</div>
<p>We now identify which irrigation wells are inside each of the buffers and get the associated groundwater pumping values. The <code>st_join()</code> function from the <code>sf</code> package will do the trick.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co">#--- find irrigation wells inside the buffer and calculate total pumping  ---#</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">pumping_neaby &lt;-<span class="st"> </span><span class="kw">st_join</span>(buffers, urnrd_gw_sf)</a></code></pre></div>
<p>Let’s take a look at a USGS monitoring well (<code>site_no</code> = <span class="math inline">\(400012101323401\)</span>).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">filter</span>(pumping_neaby, site_no <span class="op">==</span><span class="st"> </span><span class="dv">400012101323401</span>, year <span class="op">==</span><span class="st"> </span><span class="dv">2010</span>)</a></code></pre></div>
<pre><code>Simple feature collection with 7 features and 4 fields
geometry type:  POLYGON
dimension:      XY
bbox:           xmin: 279690.7 ymin: 4428006 xmax: 286128 ymax: 4434444
CRS:            EPSG:32614
          site_no well_id year  vol_af                       geometry
1 400012101323401    6331 2010      NA POLYGON ((286128 4431225, 2...
2 400012101323401    1883 2010 180.189 POLYGON ((286128 4431225, 2...
3 400012101323401    2006 2010  79.201 POLYGON ((286128 4431225, 2...
4 400012101323401    2538 2010  68.205 POLYGON ((286128 4431225, 2...
5 400012101323401    2834 2010      NA POLYGON ((286128 4431225, 2...
6 400012101323401    2834 2010 122.981 POLYGON ((286128 4431225, 2...
7 400012101323401    4983 2010      NA POLYGON ((286128 4431225, 2...</code></pre>
<p>As you can see, this well has seven irrigation wells within its 2-mile radius in 2010.</p>
<p>Now, we will get total nearby pumping by monitoring well and year.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">(</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">total_pumping_nearby &lt;-<span class="st"> </span>pumping_neaby <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="st">  </span><span class="co">#--- calculate total pumping by monitoring well ---#</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(site_no, year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">nearby_pumping =</span> <span class="kw">sum</span>(vol_af, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="st">  </span><span class="co">#--- NA means 0 pumping ---#  </span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb25-8" data-line-number="8">    <span class="dt">nearby_pumping =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(nearby_pumping), <span class="dv">0</span>, nearby_pumping)</a>
<a class="sourceLine" id="cb25-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb25-10" data-line-number="10">)</a></code></pre></div>
<pre><code>Simple feature collection with 2396 features and 3 fields
geometry type:  POLYGON
dimension:      XY
bbox:           xmin: 237904.5 ymin: 4428006 xmax: 313476.5 ymax: 4545687
CRS:            EPSG:32614
# A tibble: 2,396 x 4
# Groups:   site_no [401]
   site_no      year nearby_pumping                                     geometry
 * &lt;chr&gt;       &lt;int&gt;          &lt;dbl&gt;                                &lt;POLYGON [m]&gt;
 1 4000121013…  2007           571. ((286128 4431225, 286123.6 4431057, 286110.…
 2 4000121013…  2008           772. ((286128 4431225, 286123.6 4431057, 286110.…
 3 4000121013…  2009           500. ((286128 4431225, 286123.6 4431057, 286110.…
 4 4000121013…  2010           451. ((286128 4431225, 286123.6 4431057, 286110.…
 5 4000121013…  2011           545. ((286128 4431225, 286123.6 4431057, 286110.…
 6 4000121013…  2012          1028. ((286128 4431225, 286123.6 4431057, 286110.…
 7 4001301013…  2007           485. ((278847.4 4433844, 278843 4433675, 278829.…
 8 4001301013…  2008           515. ((278847.4 4433844, 278843 4433675, 278829.…
 9 4001301013…  2009           351. ((278847.4 4433844, 278843 4433675, 278829.…
10 4001301013…  2010           374. ((278847.4 4433844, 278843 4433675, 278829.…
# … with 2,386 more rows</code></pre>
<hr />
<p>We now merge nearby pumping data to the groundwater level data, and transform the data to obtain the dataset ready for regression analysis.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co">#--- regression-ready data ---#</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">reg_data &lt;-<span class="st"> </span>NE_gwl_march <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="st">  </span><span class="co">#--- pick monitoring wells that are inside the three counties ---#</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(site_no <span class="op">%in%</span><span class="st"> </span><span class="kw">unique</span>(sites_info<span class="op">$</span>site_no)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="st">  </span><span class="co">#--- merge with the nearby pumping data ---#</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="st">  </span><span class="kw">left_join</span>(., total_pumping_nearby, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;site_no&quot;</span>, <span class="st">&quot;year&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="st">  </span><span class="co">#--- lead depth to water table ---#</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="st">  </span><span class="kw">arrange</span>(site_no, year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9"><span class="st">  </span><span class="kw">group_by</span>(site_no) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb27-11" data-line-number="11">    <span class="co">#--- lead depth ---#</span></a>
<a class="sourceLine" id="cb27-12" data-line-number="12">    <span class="dt">dwt_lead1 =</span> dplyr<span class="op">::</span><span class="kw">lead</span>(dwt, <span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">default =</span> <span class="ot">NA</span>, <span class="dt">order_by =</span> year),</a>
<a class="sourceLine" id="cb27-13" data-line-number="13">    <span class="co">#--- first order difference in dwt  ---#</span></a>
<a class="sourceLine" id="cb27-14" data-line-number="14">    <span class="dt">dwt_dif  =</span> dwt_lead1 <span class="op">-</span><span class="st"> </span>dwt</a>
<a class="sourceLine" id="cb27-15" data-line-number="15">  )  </a>
<a class="sourceLine" id="cb27-16" data-line-number="16"></a>
<a class="sourceLine" id="cb27-17" data-line-number="17"><span class="co">#--- take a look ---#</span></a>
<a class="sourceLine" id="cb27-18" data-line-number="18">dplyr<span class="op">::</span><span class="kw">select</span>(reg_data, site_no, year, dwt_dif, nearby_pumping)</a></code></pre></div>
<pre><code># A tibble: 2,022 x 4
# Groups:   site_no [230]
   site_no          year dwt_dif nearby_pumping
   &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;          &lt;dbl&gt;
 1 400130101374401  2011   NA              358.
 2 400134101483501  2007    2.87          2038.
 3 400134101483501  2008    0.78          2320.
 4 400134101483501  2009   -2.45          2096.
 5 400134101483501  2010    3.97          2432.
 6 400134101483501  2011    1.84          2634.
 7 400134101483501  2012   -1.35           985.
 8 400134101483501  2013   44.8             NA 
 9 400134101483501  2014  -26.7             NA 
10 400134101483501  2015   NA               NA 
# … with 2,012 more rows</code></pre>
<hr />
<p>Finally, we estimate the model using the <code>lfe</code> package.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co">#--- load the lfe package for regression with fixed effects ---#</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw">library</span>(lfe)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="co">#--- OLS with site_no and year FEs (error clustered by site_no) ---#</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5">reg_dwt &lt;-<span class="st"> </span><span class="kw">felm</span>(dwt_dif <span class="op">~</span><span class="st"> </span>nearby_pumping <span class="op">|</span><span class="st"> </span>site_no <span class="op">+</span><span class="st"> </span>year <span class="op">|</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>site_no, <span class="dt">data =</span> reg_data)</a></code></pre></div>
<p>Here is the regression result.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">stargazer</span>(reg_dwt, <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>)</a></code></pre></div>
<table style="text-align:center">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
dwt_dif
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
nearby_pumping
</td>
<td>
0.001<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.0001)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
1,342
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.409
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.286
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
1.493 (df = 1111)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="12">
<li id="fn12"><p>the distance from the surface to the top of the aquifer<a href="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table.html#fnref12" class="footnote-back">↩</a></p></li>
<li id="fn13"><p>For our geographic focus of southwest Nebraska, corn is the dominant crop type. Irrigation for corn happens typically between April through September. For example, this means that changes in groundwater level (<span class="math inline">\(y_{i,2012} - y_{i,2011}\)</span>) captures the impact of groundwater pumping that occurred April through September in 2011.<a href="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table.html#fnref13" class="footnote-back">↩</a></p></li>
<li id="fn14"><p><code>month()</code> and <code>year()</code> are from the <code>lubridate</code> package. They extract month and year from a <code>Date</code> object.<a href="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table.html#fnref14" class="footnote-back">↩</a></p></li>
<li id="fn15"><p>This can alternatively be done using the <code>st_is_within_distance()</code> function.<a href="demonstration-1-the-impact-of-groundwater-pumping-on-depth-to-water-table.html#fnref15" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="demonstration-2-precision-agriculture.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
