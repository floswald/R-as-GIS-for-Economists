<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.5 Demonstration 5: Groundwater use for agricultural irrigation | R as GIS for Economists</title>
  <meta name="description" content="This is a book for Economists who regularly use spatial datasets for their econometric work." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="1.5 Demonstration 5: Groundwater use for agricultural irrigation | R as GIS for Economists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book for Economists who regularly use spatial datasets for their econometric work." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.5 Demonstration 5: Groundwater use for agricultural irrigation | R as GIS for Economists" />
  
  <meta name="twitter:description" content="This is a book for Economists who regularly use spatial datasets for their econometric work." />
  

<meta name="author" content="Taro Mieno" />


<meta name="date" content="2021-10-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="demo4.html"/>
<link rel="next" href="vector-basics.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.13/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R as GIS for Economists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="why-r-as-gis-for-economists.html"><a href="why-r-as-gis-for-economists.html"><i class="fa fa-check"></i>Why R as GIS for Economists?</a>
<ul>
<li class="chapter" data-level="" data-path="why-r-as-gis-for-economists.html"><a href="why-r-as-gis-for-economists.html#r-vs-python"><i class="fa fa-check"></i>R vs Python</a></li>
<li class="chapter" data-level="" data-path="why-r-as-gis-for-economists.html"><a href="why-r-as-gis-for-economists.html#r-vs-arcgis-or-qgis"><i class="fa fa-check"></i>R vs ArcGIS or QGIS</a></li>
<li class="chapter" data-level="" data-path="why-r-as-gis-for-economists.html"><a href="why-r-as-gis-for-economists.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-is-this-book-different-from-other-online-books-and-resources.html"><a href="how-is-this-book-different-from-other-online-books-and-resources.html"><i class="fa fa-check"></i>How is this book different from other online books and resources?</a></li>
<li class="chapter" data-level="" data-path="what-is-going-to-be-covered-in-this-book.html"><a href="what-is-going-to-be-covered-in-this-book.html"><i class="fa fa-check"></i>What is going to be covered in this book?</a></li>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html"><i class="fa fa-check"></i>Conventions of the book and some notes</a>
<ul>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html#texts-in-gray-boxes"><i class="fa fa-check"></i>Texts in gray boxes</a></li>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html#colored-boxes"><i class="fa fa-check"></i>Colored Boxes</a></li>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html#parentheses-around-codes"><i class="fa fa-check"></i>Parentheses around codes</a></li>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html#footnotes"><i class="fa fa-check"></i>Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="session-information.html"><a href="session-information.html"><i class="fa fa-check"></i>Session Information</a></li>
</ul></li>
<li class="part"><span><b>I Demonstration</b></span></li>
<li class="chapter" data-level="1" data-path="demo.html"><a href="demo.html"><i class="fa fa-check"></i><b>1</b> R as GIS: Demonstrations</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start.html"><a href="before-you-start.html"><i class="fa fa-check"></i>Before you start</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start.html"><a href="before-you-start.html#target-audience"><i class="fa fa-check"></i>Target Audience</a></li>
<li class="chapter" data-level="" data-path="before-you-start.html"><a href="before-you-start.html#direction-for-replication"><i class="fa fa-check"></i>Direction for replication</a></li>
</ul></li>
<li class="chapter" data-level="1.1" data-path="Demo1.html"><a href="Demo1.html"><i class="fa fa-check"></i><b>1.1</b> Demonstration 1: The impact of groundwater pumping on depth to water table</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="Demo1.html"><a href="Demo1.html#project-overview"><i class="fa fa-check"></i><b>1.1.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.1.2" data-path="Demo1.html"><a href="Demo1.html#project-demonstration"><i class="fa fa-check"></i><b>1.1.2</b> Project Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="demonstration-2-precision-agriculture.html"><a href="demonstration-2-precision-agriculture.html"><i class="fa fa-check"></i><b>1.2</b> Demonstration 2: Precision Agriculture</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="demonstration-2-precision-agriculture.html"><a href="demonstration-2-precision-agriculture.html#project-overview-1"><i class="fa fa-check"></i><b>1.2.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.2.2" data-path="demonstration-2-precision-agriculture.html"><a href="demonstration-2-precision-agriculture.html#project-demonstration-1"><i class="fa fa-check"></i><b>1.2.2</b> Project Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="demo3.html"><a href="demo3.html"><i class="fa fa-check"></i><b>1.3</b> Demonstration 3: Land Use and Weather</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="demo3.html"><a href="demo3.html#project-overview-2"><i class="fa fa-check"></i><b>1.3.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.3.2" data-path="demo3.html"><a href="demo3.html#project-demonstration-2"><i class="fa fa-check"></i><b>1.3.2</b> Project Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="demo4.html"><a href="demo4.html"><i class="fa fa-check"></i><b>1.4</b> Demonstration 4: The Impact of Railroad Presence on Corn Planted Acreage</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="demo4.html"><a href="demo4.html#project-overview-3"><i class="fa fa-check"></i><b>1.4.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.4.2" data-path="demo4.html"><a href="demo4.html#project-demonstration-3"><i class="fa fa-check"></i><b>1.4.2</b> Project Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="demonstration-5-groundwater-use-for-agricultural-irrigation.html"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html"><i class="fa fa-check"></i><b>1.5</b> Demonstration 5: Groundwater use for agricultural irrigation</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="demonstration-5-groundwater-use-for-agricultural-irrigation.html"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#project-overview-4"><i class="fa fa-check"></i><b>1.5.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.5.2" data-path="demonstration-5-groundwater-use-for-agricultural-irrigation.html"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#project-demonstration-4"><i class="fa fa-check"></i><b>1.5.2</b> Project Demonstration</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Foundations</b></span></li>
<li class="chapter" data-level="2" data-path="vector-basics.html"><a href="vector-basics.html"><i class="fa fa-check"></i><b>2</b> Vector Data Handling with <code>sf</code></a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-1.html"><a href="before-you-start-1.html"><i class="fa fa-check"></i>Before you start</a>
<ul>
<li><a href="before-you-start-1.html#sf-or-sp"><code>sf</code> or <code>sp</code>?</a></li>
<li class="chapter" data-level="" data-path="before-you-start-1.html"><a href="before-you-start-1.html#direction-for-replication-1"><i class="fa fa-check"></i>Direction for replication</a></li>
</ul></li>
<li class="chapter" data-level="2.1" data-path="spatial-data-structure.html"><a href="spatial-data-structure.html"><i class="fa fa-check"></i><b>2.1</b> Spatial Data Structure</a></li>
<li class="chapter" data-level="2.2" data-path="simple-feature-geometry-simple-feature-geometry-list-column-and-simple-feature.html"><a href="simple-feature-geometry-simple-feature-geometry-list-column-and-simple-feature.html"><i class="fa fa-check"></i><b>2.2</b> Simple feature geometry, simple feature geometry list-column, and simple feature</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="simple-feature-geometry-simple-feature-geometry-list-column-and-simple-feature.html"><a href="simple-feature-geometry-simple-feature-geometry-list-column-and-simple-feature.html#simple-feature-geometry-sfg"><i class="fa fa-check"></i><b>2.2.1</b> Simple feature geometry (<code>sfg</code>)</a></li>
<li class="chapter" data-level="2.2.2" data-path="simple-feature-geometry-simple-feature-geometry-list-column-and-simple-feature.html"><a href="simple-feature-geometry-simple-feature-geometry-list-column-and-simple-feature.html#create-simple-feature-geometry-list-column-sfc-and-simple-feature-sf-from-scratch"><i class="fa fa-check"></i><b>2.2.2</b> Create simple feature geometry list-column (<code>sfc</code>) and simple feature (<code>sf</code>) from scratch</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="reading-and-writing-vector-data.html"><a href="reading-and-writing-vector-data.html"><i class="fa fa-check"></i><b>2.3</b> Reading and writing vector data</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="reading-and-writing-vector-data.html"><a href="reading-and-writing-vector-data.html#reading-a-shapefile"><i class="fa fa-check"></i><b>2.3.1</b> Reading a shapefile</a></li>
<li class="chapter" data-level="2.3.2" data-path="reading-and-writing-vector-data.html"><a href="reading-and-writing-vector-data.html#writing-to-a-shapefile"><i class="fa fa-check"></i><b>2.3.2</b> Writing to a shapefile</a></li>
<li class="chapter" data-level="2.3.3" data-path="reading-and-writing-vector-data.html"><a href="reading-and-writing-vector-data.html#better-alternatives"><i class="fa fa-check"></i><b>2.3.3</b> Better alternatives</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="projection-with-a-different-coordinate-reference-systems.html"><a href="projection-with-a-different-coordinate-reference-systems.html"><i class="fa fa-check"></i><b>2.4</b> Projection with a different Coordinate Reference Systems</a></li>
<li class="chapter" data-level="2.5" data-path="quick-and-interactive-view-of-an-sf-object.html"><a href="quick-and-interactive-view-of-an-sf-object.html"><i class="fa fa-check"></i><b>2.5</b> Quick and interactive view of an <code>sf</code> object</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="quick-and-interactive-view-of-an-sf-object.html"><a href="quick-and-interactive-view-of-an-sf-object.html#quick-view"><i class="fa fa-check"></i><b>2.5.1</b> Quick view</a></li>
<li class="chapter" data-level="2.5.2" data-path="quick-and-interactive-view-of-an-sf-object.html"><a href="quick-and-interactive-view-of-an-sf-object.html#interactive-view"><i class="fa fa-check"></i><b>2.5.2</b> Interactive view</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="turning-a-data-frame-of-points-into-an-sf.html"><a href="turning-a-data-frame-of-points-into-an-sf.html"><i class="fa fa-check"></i><b>2.6</b> Turning a data.frame of points into an <code>sf</code></a></li>
<li class="chapter" data-level="2.7" data-path="conv-sp.html"><a href="conv-sp.html"><i class="fa fa-check"></i><b>2.7</b> Conversion to and from sp objects</a></li>
<li class="chapter" data-level="2.8" data-path="non-spatial-transformation-of-sf.html"><a href="non-spatial-transformation-of-sf.html"><i class="fa fa-check"></i><b>2.8</b> Non-spatial transformation of <code>sf</code></a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="non-spatial-transformation-of-sf.html"><a href="non-spatial-transformation-of-sf.html#using-dplyr"><i class="fa fa-check"></i><b>2.8.1</b> Using <code>dplyr</code></a></li>
<li class="chapter" data-level="2.8.2" data-path="non-spatial-transformation-of-sf.html"><a href="non-spatial-transformation-of-sf.html#using-data.table"><i class="fa fa-check"></i><b>2.8.2</b> Using <code>data.table</code></a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="non-interactive-geometrical-operations.html"><a href="non-interactive-geometrical-operations.html"><i class="fa fa-check"></i><b>2.9</b> Non-interactive geometrical operations</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="non-interactive-geometrical-operations.html"><a href="non-interactive-geometrical-operations.html#st_buffer"><i class="fa fa-check"></i><b>2.9.1</b> st_buffer</a></li>
<li class="chapter" data-level="2.9.2" data-path="non-interactive-geometrical-operations.html"><a href="non-interactive-geometrical-operations.html#st_area"><i class="fa fa-check"></i><b>2.9.2</b> st_area</a></li>
<li class="chapter" data-level="2.9.3" data-path="non-interactive-geometrical-operations.html"><a href="non-interactive-geometrical-operations.html#st_centroid"><i class="fa fa-check"></i><b>2.9.3</b> st_centroid</a></li>
<li class="chapter" data-level="2.9.4" data-path="non-interactive-geometrical-operations.html"><a href="non-interactive-geometrical-operations.html#st_length"><i class="fa fa-check"></i><b>2.9.4</b> st_length</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="int-vv.html"><a href="int-vv.html"><i class="fa fa-check"></i><b>3</b> Spatial Interactions of Vector Data: Subsetting and Joining</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-2.html"><a href="before-you-start-2.html"><i class="fa fa-check"></i>Before you start</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-2.html"><a href="before-you-start-2.html#direction-for-replication-2"><i class="fa fa-check"></i>Direction for replication</a></li>
</ul></li>
<li class="chapter" data-level="3.1" data-path="topo.html"><a href="topo.html"><i class="fa fa-check"></i><b>3.1</b> Topological relations</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="topo.html"><a href="topo.html#st_intersects"><i class="fa fa-check"></i><b>3.1.1</b> st_intersects()</a></li>
<li class="chapter" data-level="3.1.2" data-path="topo.html"><a href="topo.html#st_is_within_distance"><i class="fa fa-check"></i><b>3.1.2</b> st_is_within_distance()</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="spatial-subsetting-or-flagging.html"><a href="spatial-subsetting-or-flagging.html"><i class="fa fa-check"></i><b>3.2</b> Spatial Subsetting (or Flagging)</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="spatial-subsetting-or-flagging.html"><a href="spatial-subsetting-or-flagging.html#polygons-source-vs-polygons-target"><i class="fa fa-check"></i><b>3.2.1</b> polygons (source) vs polygons (target)</a></li>
<li class="chapter" data-level="3.2.2" data-path="spatial-subsetting-or-flagging.html"><a href="spatial-subsetting-or-flagging.html#points-source-vs-polygons-target"><i class="fa fa-check"></i><b>3.2.2</b> points (source) vs polygons (target)</a></li>
<li class="chapter" data-level="3.2.3" data-path="spatial-subsetting-or-flagging.html"><a href="spatial-subsetting-or-flagging.html#lines_polygons"><i class="fa fa-check"></i><b>3.2.3</b> lines (source) vs polygons (target)</a></li>
<li class="chapter" data-level="3.2.4" data-path="spatial-subsetting-or-flagging.html"><a href="spatial-subsetting-or-flagging.html#polygons_points"><i class="fa fa-check"></i><b>3.2.4</b> polygons (source) vs points (target)</a></li>
<li class="chapter" data-level="3.2.5" data-path="spatial-subsetting-or-flagging.html"><a href="spatial-subsetting-or-flagging.html#subsetting-to-a-geographic-extent-bounding-box"><i class="fa fa-check"></i><b>3.2.5</b> Subsetting to a geographic extent (bounding box)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sp-join.html"><a href="sp-join.html"><i class="fa fa-check"></i><b>3.3</b> Spatial Join</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sp-join.html"><a href="sp-join.html#case-1-points-target-vs-polygons-source"><i class="fa fa-check"></i><b>3.3.1</b> Case 1: points (target) vs polygons (source)</a></li>
<li class="chapter" data-level="3.3.2" data-path="sp-join.html"><a href="sp-join.html#case-2-polygons-target-vs-points-source"><i class="fa fa-check"></i><b>3.3.2</b> Case 2: polygons (target) vs points (source)</a></li>
<li class="chapter" data-level="3.3.3" data-path="sp-join.html"><a href="sp-join.html#polygon-polygon"><i class="fa fa-check"></i><b>3.3.3</b> Case 3: polygons (target) vs polygons (source)</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="spatial-intersection-cropping-join.html"><a href="spatial-intersection-cropping-join.html"><i class="fa fa-check"></i><b>3.4</b> Spatial Intersection (cropping join)</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="spatial-intersection-cropping-join.html"><a href="spatial-intersection-cropping-join.html#st-intersection"><i class="fa fa-check"></i><b>3.4.1</b> <code>st_intersection()</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="spatial-intersection-cropping-join.html"><a href="spatial-intersection-cropping-join.html#area-weighted-average"><i class="fa fa-check"></i><b>3.4.2</b> Area-weighted average</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="raster-basics.html"><a href="raster-basics.html"><i class="fa fa-check"></i><b>4</b> Raster Data Handling</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-3.html"><a href="before-you-start-3.html"><i class="fa fa-check"></i>Before you start</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-3.html"><a href="before-you-start-3.html#direction-for-replication-3"><i class="fa fa-check"></i>Direction for replication</a></li>
</ul></li>
<li class="chapter" data-level="4.1" data-path="raster-data-object-classes.html"><a href="raster-data-object-classes.html"><i class="fa fa-check"></i><b>4.1</b> Raster data object classes</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="raster-data-object-classes.html"><a href="raster-data-object-classes.html#raster-package-rasterlayer-rasterstack-and-rasterbrick"><i class="fa fa-check"></i><b>4.1.1</b> <code>raster</code> package: <code>RasterLayer</code>, <code>RasterStack</code>, and <code>RasterBrick</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="raster-data-object-classes.html"><a href="raster-data-object-classes.html#terra-package-spatraster"><i class="fa fa-check"></i><b>4.1.2</b> <code>terra</code> package: <code>SpatRaster</code></a></li>
<li class="chapter" data-level="4.1.3" data-path="raster-data-object-classes.html"><a href="raster-data-object-classes.html#converting-a-spatraster-object-to-a-raster-object."><i class="fa fa-check"></i><b>4.1.3</b> Converting a <code>SpatRaster</code> object to a <code>Raster</code><span class="math inline">\(^*\)</span> object.</a></li>
<li class="chapter" data-level="4.1.4" data-path="raster-data-object-classes.html"><a href="raster-data-object-classes.html#vector-data-in-the-terra-package"><i class="fa fa-check"></i><b>4.1.4</b> Vector data in the <code>terra</code> package</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="read-and-write-a-raster-data-file.html"><a href="read-and-write-a-raster-data-file.html"><i class="fa fa-check"></i><b>4.2</b> Read and write a raster data file</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="read-and-write-a-raster-data-file.html"><a href="read-and-write-a-raster-data-file.html#read-raster-files"><i class="fa fa-check"></i><b>4.2.1</b> Read raster file(s)</a></li>
<li class="chapter" data-level="4.2.2" data-path="read-and-write-a-raster-data-file.html"><a href="read-and-write-a-raster-data-file.html#write-raster-files"><i class="fa fa-check"></i><b>4.2.2</b> Write raster files</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="extract-information-from-raster-data-object.html"><a href="extract-information-from-raster-data-object.html"><i class="fa fa-check"></i><b>4.3</b> Extract information from raster data object</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="extract-information-from-raster-data-object.html"><a href="extract-information-from-raster-data-object.html#get-crs"><i class="fa fa-check"></i><b>4.3.1</b> Get CRS</a></li>
<li class="chapter" data-level="4.3.2" data-path="extract-information-from-raster-data-object.html"><a href="extract-information-from-raster-data-object.html#subset"><i class="fa fa-check"></i><b>4.3.2</b> Subset</a></li>
<li class="chapter" data-level="4.3.3" data-path="extract-information-from-raster-data-object.html"><a href="extract-information-from-raster-data-object.html#get-cell-values"><i class="fa fa-check"></i><b>4.3.3</b> Get cell values</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="turning-a-raster-object-into-a-data-frame.html"><a href="turning-a-raster-object-into-a-data-frame.html"><i class="fa fa-check"></i><b>4.4</b> Turning a raster object into a <code>data.frame</code></a></li>
<li class="chapter" data-level="4.5" data-path="quick-plot-and-interactive-map.html"><a href="quick-plot-and-interactive-map.html"><i class="fa fa-check"></i><b>4.5</b> Quick plot and interactive map</a></li>
<li class="chapter" data-level="4.6" data-path="working-with-netcdfs.html"><a href="working-with-netcdfs.html"><i class="fa fa-check"></i><b>4.6</b> Working with netCDFs</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="int-RV.html"><a href="int-RV.html"><i class="fa fa-check"></i><b>5</b> Spatial Interactions of Vector and Raster Data</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-4.html"><a href="before-you-start-4.html"><i class="fa fa-check"></i>Before you start</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-4.html"><a href="before-you-start-4.html#direction-for-replication-4"><i class="fa fa-check"></i>Direction for replication</a></li>
</ul></li>
<li class="chapter" data-level="5.1" data-path="raster-crop.html"><a href="raster-crop.html"><i class="fa fa-check"></i><b>5.1</b> Cropping to the Area of Interest</a></li>
<li class="chapter" data-level="5.2" data-path="extracting-values-from-raster-layers-for-vector-data.html"><a href="extracting-values-from-raster-layers-for-vector-data.html"><i class="fa fa-check"></i><b>5.2</b> Extracting Values from Raster Layers for Vector Data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="extracting-values-from-raster-layers-for-vector-data.html"><a href="extracting-values-from-raster-layers-for-vector-data.html#simple-visual-illustrations-of-raster-data-extraction"><i class="fa fa-check"></i><b>5.2.1</b> Simple visual illustrations of raster data extraction</a></li>
<li class="chapter" data-level="5.2.2" data-path="extracting-values-from-raster-layers-for-vector-data.html"><a href="extracting-values-from-raster-layers-for-vector-data.html#extracting-to-points"><i class="fa fa-check"></i><b>5.2.2</b> Extracting to Points</a></li>
<li class="chapter" data-level="5.2.3" data-path="extracting-values-from-raster-layers-for-vector-data.html"><a href="extracting-values-from-raster-layers-for-vector-data.html#extracting-to-polygons-terra-way"><i class="fa fa-check"></i><b>5.2.3</b> Extracting to Polygons (<code>terra</code> way)</a></li>
<li class="chapter" data-level="5.2.4" data-path="extracting-values-from-raster-layers-for-vector-data.html"><a href="extracting-values-from-raster-layers-for-vector-data.html#extracting-to-polygons-exactextractr-way"><i class="fa fa-check"></i><b>5.2.4</b> Extracting to Polygons (<code>exactextractr</code> way)</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="extract-speed.html"><a href="extract-speed.html"><i class="fa fa-check"></i><b>5.3</b> Extraction speed comparison</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="extract-speed.html"><a href="extract-speed.html#points-terraextract-and-rasterextract"><i class="fa fa-check"></i><b>5.3.1</b> Points: <code>terra::extract()</code> and <code>raster::extract()</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="extract-speed.html"><a href="extract-speed.html#polygons-exact_extract-terraextract-and-rasterextract"><i class="fa fa-check"></i><b>5.3.2</b> Polygons: <code>exact_extract()</code>, <code>terra::extract()</code>, and <code>raster::extract()</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="extract-speed.html"><a href="extract-speed.html#single-layer-vs-multi-layer"><i class="fa fa-check"></i><b>5.3.3</b> Single-layer vs multi-layer</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III (slightly) Advanced Topics</b></span></li>
<li class="chapter" data-level="6" data-path="EE.html"><a href="EE.html"><i class="fa fa-check"></i><b>6</b> Extraction Speed Considerations</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-5.html"><a href="before-you-start-5.html"><i class="fa fa-check"></i>Before you start</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-5.html"><a href="before-you-start-5.html#direction-for-replication-5"><i class="fa fa-check"></i>Direction for replication</a></li>
</ul></li>
<li class="chapter" data-level="6.1" data-path="single-raster-layer.html"><a href="single-raster-layer.html"><i class="fa fa-check"></i><b>6.1</b> Single raster layer</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="single-raster-layer.html"><a href="single-raster-layer.html#datasets"><i class="fa fa-check"></i><b>6.1.1</b> Datasets</a></li>
<li class="chapter" data-level="6.1.2" data-path="single-raster-layer.html"><a href="single-raster-layer.html#parallelization"><i class="fa fa-check"></i><b>6.1.2</b> Parallelization</a></li>
<li class="chapter" data-level="6.1.3" data-path="single-raster-layer.html"><a href="single-raster-layer.html#summary-1"><i class="fa fa-check"></i><b>6.1.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="many-multi-layer.html"><a href="many-multi-layer.html"><i class="fa fa-check"></i><b>6.2</b> Many multi-layer raster files</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="many-multi-layer.html"><a href="many-multi-layer.html#datasets-1"><i class="fa fa-check"></i><b>6.2.1</b> Datasets</a></li>
<li class="chapter" data-level="6.2.2" data-path="many-multi-layer.html"><a href="many-multi-layer.html#non-par-ext-multi"><i class="fa fa-check"></i><b>6.2.2</b> Non-parallelized extraction</a></li>
<li class="chapter" data-level="6.2.3" data-path="many-multi-layer.html"><a href="many-multi-layer.html#approach-1-parallelize-over-polygons-and-do-regular-loop-over-year-month"><i class="fa fa-check"></i><b>6.2.3</b> Approach 1: parallelize over polygons and do regular loop over year-month</a></li>
<li class="chapter" data-level="6.2.4" data-path="many-multi-layer.html"><a href="many-multi-layer.html#approach-2-parallelize-over-the-temporal-dimension-year-month"><i class="fa fa-check"></i><b>6.2.4</b> Approach 2: parallelize over the temporal dimension (year-month)</a></li>
<li class="chapter" data-level="6.2.5" data-path="many-multi-layer.html"><a href="many-multi-layer.html#memory-consideration"><i class="fa fa-check"></i><b>6.2.5</b> Memory consideration</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="stars-basics.html"><a href="stars-basics.html"><i class="fa fa-check"></i><b>7</b> Spatiotemporal Raster Data Handling with <code>stars</code></a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-6.html"><a href="before-you-start-6.html"><i class="fa fa-check"></i>Before you start</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-6.html"><a href="before-you-start-6.html#direction-for-replication-6"><i class="fa fa-check"></i>Direction for replication</a></li>
</ul></li>
<li class="chapter" data-level="7.1" data-path="stars-structure.html"><a href="stars-structure.html"><i class="fa fa-check"></i><b>7.1</b> Understanding the structure of a <code>stars</code> object</a></li>
<li class="chapter" data-level="7.2" data-path="some-basic-operations-on-stars-objects.html"><a href="some-basic-operations-on-stars-objects.html"><i class="fa fa-check"></i><b>7.2</b> Some basic operations on <code>stars</code> objects</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="some-basic-operations-on-stars-objects.html"><a href="some-basic-operations-on-stars-objects.html#subset-a-stars-object-by-index"><i class="fa fa-check"></i><b>7.2.1</b> Subset a <code>stars</code> object by index</a></li>
<li class="chapter" data-level="7.2.2" data-path="some-basic-operations-on-stars-objects.html"><a href="some-basic-operations-on-stars-objects.html#set-attribute-names"><i class="fa fa-check"></i><b>7.2.2</b> Set attribute names</a></li>
<li class="chapter" data-level="7.2.3" data-path="some-basic-operations-on-stars-objects.html"><a href="some-basic-operations-on-stars-objects.html#get-the-coordinate-reference-system"><i class="fa fa-check"></i><b>7.2.3</b> Get the coordinate reference system</a></li>
<li class="chapter" data-level="7.2.4" data-path="some-basic-operations-on-stars-objects.html"><a href="some-basic-operations-on-stars-objects.html#get-the-dimension-characteristics-and-values"><i class="fa fa-check"></i><b>7.2.4</b> Get the dimension characteristics and values</a></li>
<li class="chapter" data-level="7.2.5" data-path="some-basic-operations-on-stars-objects.html"><a href="some-basic-operations-on-stars-objects.html#attributes-to-dimensions-and-vice-versa"><i class="fa fa-check"></i><b>7.2.5</b> Attributes to dimensions, and vice versa</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="quick-visualization-for-exploration.html"><a href="quick-visualization-for-exploration.html"><i class="fa fa-check"></i><b>7.3</b> Quick visualization for exploration</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="quick-visualization-for-exploration.html"><a href="quick-visualization-for-exploration.html#quick-static-map"><i class="fa fa-check"></i><b>7.3.1</b> quick static map</a></li>
<li class="chapter" data-level="7.3.2" data-path="quick-visualization-for-exploration.html"><a href="quick-visualization-for-exploration.html#interactive-map"><i class="fa fa-check"></i><b>7.3.2</b> interactive map</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="read-write-stars.html"><a href="read-write-stars.html"><i class="fa fa-check"></i><b>7.4</b> Reading and writing raster data</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="read-write-stars.html"><a href="read-write-stars.html#reading-raster-data"><i class="fa fa-check"></i><b>7.4.1</b> Reading raster data</a></li>
<li class="chapter" data-level="7.4.2" data-path="read-write-stars.html"><a href="read-write-stars.html#writing-a-stars-object-to-a-file"><i class="fa fa-check"></i><b>7.4.2</b> Writing a <code>stars</code> object to a file</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="stars-set-time.html"><a href="stars-set-time.html"><i class="fa fa-check"></i><b>7.5</b> Setting the time dimension manually</a></li>
<li class="chapter" data-level="7.6" data-path="dplyr-op.html"><a href="dplyr-op.html"><i class="fa fa-check"></i><b>7.6</b> <code>dplyr</code>-like operations</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="dplyr-op.html"><a href="dplyr-op.html#filter"><i class="fa fa-check"></i><b>7.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="7.6.2" data-path="dplyr-op.html"><a href="dplyr-op.html#select"><i class="fa fa-check"></i><b>7.6.2</b> <code>select()</code></a></li>
<li class="chapter" data-level="7.6.3" data-path="dplyr-op.html"><a href="dplyr-op.html#mutate"><i class="fa fa-check"></i><b>7.6.3</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="7.6.4" data-path="dplyr-op.html"><a href="dplyr-op.html#pull"><i class="fa fa-check"></i><b>7.6.4</b> <code>pull()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="merging-stars-objects-using-c-and-st-mosaic.html"><a href="merging-stars-objects-using-c-and-st-mosaic.html"><i class="fa fa-check"></i><b>7.7</b> Merging <code>stars</code> objects using <code>c()</code> and <code>st_mosaic()</code></a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="merging-stars-objects-using-c-and-st-mosaic.html"><a href="merging-stars-objects-using-c-and-st-mosaic.html#merging-stars-objects-along-the-third-dimension-band"><i class="fa fa-check"></i><b>7.7.1</b> Merging <code>stars</code> objects along the third dimension (band)</a></li>
<li class="chapter" data-level="7.7.2" data-path="merging-stars-objects-using-c-and-st-mosaic.html"><a href="merging-stars-objects-using-c-and-st-mosaic.html#merge-two"><i class="fa fa-check"></i><b>7.7.2</b> Merging <code>stars</code> objects of different attributes</a></li>
<li class="chapter" data-level="7.7.3" data-path="merging-stars-objects-using-c-and-st-mosaic.html"><a href="merging-stars-objects-using-c-and-st-mosaic.html#merging-stars-objects-of-different-spatial-extents"><i class="fa fa-check"></i><b>7.7.3</b> Merging <code>stars</code> objects of different spatial extents</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="convert-to-rb.html"><a href="convert-to-rb.html"><i class="fa fa-check"></i><b>7.8</b> Convert from and to <code>Raster</code><span class="math inline">\(^*\)</span> objects</a></li>
</ul></li>
<li class="part"><span><b>IV Extensions</b></span></li>
<li class="chapter" data-level="8" data-path="create-maps.html"><a href="create-maps.html"><i class="fa fa-check"></i><b>8</b> Creating Maps using <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-7.html"><a href="before-you-start-7.html"><i class="fa fa-check"></i>Before you start</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-7.html"><a href="before-you-start-7.html#direction-for-replication-7"><i class="fa fa-check"></i>Direction for replication</a></li>
</ul></li>
<li class="chapter" data-level="8.1" data-path="geom-sf.html"><a href="geom-sf.html"><i class="fa fa-check"></i><b>8.1</b> Creating maps from <code>sf</code> objects</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="geom-sf.html"><a href="geom-sf.html#datasets-2"><i class="fa fa-check"></i><b>8.1.1</b> Datasets</a></li>
<li class="chapter" data-level="8.1.2" data-path="geom-sf.html"><a href="geom-sf.html#basic-usage-of-geom_sf"><i class="fa fa-check"></i><b>8.1.2</b> Basic usage of <code>geom_sf()</code></a></li>
<li class="chapter" data-level="8.1.3" data-path="geom-sf.html"><a href="geom-sf.html#specifying-the-aesthetics"><i class="fa fa-check"></i><b>8.1.3</b> Specifying the aesthetics</a></li>
<li class="chapter" data-level="8.1.4" data-path="geom-sf.html"><a href="geom-sf.html#plotting-multiple-spatial-objects-in-one-figure"><i class="fa fa-check"></i><b>8.1.4</b> Plotting multiple spatial objects in one figure</a></li>
<li class="chapter" data-level="8.1.5" data-path="geom-sf.html"><a href="geom-sf.html#crs"><i class="fa fa-check"></i><b>8.1.5</b> CRS</a></li>
<li class="chapter" data-level="8.1.6" data-path="geom-sf.html"><a href="geom-sf.html#faceting"><i class="fa fa-check"></i><b>8.1.6</b> Faceting</a></li>
<li class="chapter" data-level="8.1.7" data-path="geom-sf.html"><a href="geom-sf.html#adding-texts-labels-on-a-map"><i class="fa fa-check"></i><b>8.1.7</b> Adding texts (labels) on a map</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="geom-raster.html"><a href="geom-raster.html"><i class="fa fa-check"></i><b>8.2</b> Raster data visualization: <code>geom_raster()</code> and <code>geom_stars()</code></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="geom-raster.html"><a href="geom-raster.html#visualize-raster-with-geom_raster"><i class="fa fa-check"></i><b>8.2.1</b> Visualize <code>Raster</code><span class="math inline">\(^*\)</span> with <code>geom_raster()</code></a></li>
<li class="chapter" data-level="8.2.2" data-path="geom-raster.html"><a href="geom-raster.html#visualize-stars-with-geom_raster"><i class="fa fa-check"></i><b>8.2.2</b> Visualize <code>stars</code> with <code>geom_raster()</code></a></li>
<li class="chapter" data-level="8.2.3" data-path="geom-raster.html"><a href="geom-raster.html#visualize-stars-with-geom_stars"><i class="fa fa-check"></i><b>8.2.3</b> Visualize <code>stars</code> with <code>geom_stars()</code></a></li>
<li class="chapter" data-level="8.2.4" data-path="geom-raster.html"><a href="geom-raster.html#adding-geom_sf-layers"><i class="fa fa-check"></i><b>8.2.4</b> adding <code>geom_sf()</code> layers</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="color-scale.html"><a href="color-scale.html"><i class="fa fa-check"></i><b>8.3</b> Color scale</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="color-scale.html"><a href="color-scale.html#viridis-color-maps"><i class="fa fa-check"></i><b>8.3.1</b> Viridis color maps</a></li>
<li class="chapter" data-level="8.3.2" data-path="color-scale.html"><a href="color-scale.html#rcolorbrewer-scale__distiller-and-scale__brewer"><i class="fa fa-check"></i><b>8.3.2</b> <code>RColorBrewer</code>: <code>scale_*_distiller()</code> and <code>scale_*_brewer()</code></a></li>
<li class="chapter" data-level="8.3.3" data-path="color-scale.html"><a href="color-scale.html#colorspace-package"><i class="fa fa-check"></i><b>8.3.3</b> <code>colorspace</code> package</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="arranging-maps.html"><a href="arranging-maps.html"><i class="fa fa-check"></i><b>8.4</b> Arranging maps</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="arranging-maps.html"><a href="arranging-maps.html#multiple-panels-of-figures-as-a-single-figure"><i class="fa fa-check"></i><b>8.4.1</b> Multiple panels of figures as a single figure</a></li>
<li class="chapter" data-level="8.4.2" data-path="arranging-maps.html"><a href="arranging-maps.html#a-map-in-a-map-inset"><i class="fa fa-check"></i><b>8.4.2</b> A map in a map: inset</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="fine-tune.html"><a href="fine-tune.html"><i class="fa fa-check"></i><b>8.5</b> Fine-tuning maps for publication</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="fine-tune.html"><a href="fine-tune.html#theme"><i class="fa fa-check"></i><b>8.5.1</b> Setting the theme</a></li>
<li class="chapter" data-level="8.5.2" data-path="fine-tune.html"><a href="fine-tune.html#legend"><i class="fa fa-check"></i><b>8.5.2</b> Legend</a></li>
<li class="chapter" data-level="8.5.3" data-path="fine-tune.html"><a href="fine-tune.html#facet-strips"><i class="fa fa-check"></i><b>8.5.3</b> Facet strips</a></li>
<li class="chapter" data-level="8.5.4" data-path="fine-tune.html"><a href="fine-tune.html#north-arrow-and-scale-bar"><i class="fa fa-check"></i><b>8.5.4</b> North arrow and scale bar</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="ggsave.html"><a href="ggsave.html"><i class="fa fa-check"></i><b>8.6</b> Saving a <code>ggplot</code> object as an image</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="download-data.html"><a href="download-data.html"><i class="fa fa-check"></i><b>9</b> Download and process spatial datasets from within R</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-8.html"><a href="before-you-start-8.html"><i class="fa fa-check"></i>Before you start</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-8.html"><a href="before-you-start-8.html#direction-for-replication-8"><i class="fa fa-check"></i>Direction for replication</a></li>
</ul></li>
<li class="chapter" data-level="9.1" data-path="nass-quick.html"><a href="nass-quick.html"><i class="fa fa-check"></i><b>9.1</b> USDA NASS QuickStat with <code>tidyUSDA</code></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="nass-quick.html"><a href="nass-quick.html#look-for-parameter-values"><i class="fa fa-check"></i><b>9.1.1</b> Look for parameter values</a></li>
<li class="chapter" data-level="9.1.2" data-path="nass-quick.html"><a href="nass-quick.html#caveats"><i class="fa fa-check"></i><b>9.1.2</b> Caveats</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="CropScapeR.html"><a href="CropScapeR.html"><i class="fa fa-check"></i><b>9.2</b> CDL with <code>CropScapeR</code></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="CropScapeR.html"><a href="CropScapeR.html#getcdldata-download-the-cdl-data-as-raster-data"><i class="fa fa-check"></i><b>9.2.1</b> <code>GetCDLData</code>: Download the CDL data as raster data</a></li>
<li class="chapter" data-level="9.2.2" data-path="CropScapeR.html"><a href="CropScapeR.html#data-processing-after-downloading-data"><i class="fa fa-check"></i><b>9.2.2</b> Data processing after downloading data</a></li>
<li class="chapter" data-level="9.2.3" data-path="CropScapeR.html"><a href="CropScapeR.html#other-forms-of-cdl-data"><i class="fa fa-check"></i><b>9.2.3</b> Other forms of CDL data</a></li>
<li class="chapter" data-level="9.2.4" data-path="CropScapeR.html"><a href="CropScapeR.html#mac-problem"><i class="fa fa-check"></i><b>9.2.4</b> SSL certificate problem on Mac</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="download-prism.html"><a href="download-prism.html"><i class="fa fa-check"></i><b>9.3</b> PRISM with <code>prism</code></a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="download-prism.html"><a href="download-prism.html#basics"><i class="fa fa-check"></i><b>9.3.1</b> Basics</a></li>
<li class="chapter" data-level="9.3.2" data-path="download-prism.html"><a href="download-prism.html#download-daily-prism-data-for-many-years-and-build-your-own-datasets"><i class="fa fa-check"></i><b>9.3.2</b> Download daily PRISM data for many years and build your own datasets</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="daymet-with-daymetr-and-feddata.html"><a href="daymet-with-daymetr-and-feddata.html"><i class="fa fa-check"></i><b>9.4</b> Daymet with <code>daymetr</code> and <code>FedData</code></a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="daymet-with-daymetr-and-feddata.html"><a href="daymet-with-daymetr-and-feddata.html#for-points-data"><i class="fa fa-check"></i><b>9.4.1</b> For points data</a></li>
<li class="chapter" data-level="9.4.2" data-path="daymet-with-daymetr-and-feddata.html"><a href="daymet-with-daymetr-and-feddata.html#daymet-poly"><i class="fa fa-check"></i><b>9.4.2</b> For polygons data</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="gridMET.html"><a href="gridMET.html"><i class="fa fa-check"></i><b>9.5</b> gridMET</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="gridMET.html"><a href="gridMET.html#practical-examples"><i class="fa fa-check"></i><b>9.5.1</b> Practical Examples</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="par-comp.html"><a href="par-comp.html"><i class="fa fa-check"></i><b>A</b> Loop and Parallel Computing</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-9.html"><a href="before-you-start-9.html"><i class="fa fa-check"></i>Before you start</a>
<ul>
<li class="chapter" data-level="" data-path="before-you-start-9.html"><a href="before-you-start-9.html#direction-for-replication-9"><i class="fa fa-check"></i>Direction for replication</a></li>
<li class="chapter" data-level="" data-path="before-you-start-9.html"><a href="before-you-start-9.html#packages-to-install-and-load"><i class="fa fa-check"></i>Packages to install and load</a></li>
</ul></li>
<li class="chapter" data-level="A.1" data-path="repetitive-processes-and-looping.html"><a href="repetitive-processes-and-looping.html"><i class="fa fa-check"></i><b>A.1</b> Repetitive processes and looping</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="repetitive-processes-and-looping.html"><a href="repetitive-processes-and-looping.html#what-is-looping"><i class="fa fa-check"></i><b>A.1.1</b> What is looping?</a></li>
<li class="chapter" data-level="A.1.2" data-path="repetitive-processes-and-looping.html"><a href="repetitive-processes-and-looping.html#for-loop"><i class="fa fa-check"></i><b>A.1.2</b> For loop</a></li>
<li class="chapter" data-level="A.1.3" data-path="repetitive-processes-and-looping.html"><a href="repetitive-processes-and-looping.html#for-loop-using-the-lapply-function"><i class="fa fa-check"></i><b>A.1.3</b> For loop using the <code>lapply()</code> function</a></li>
<li class="chapter" data-level="A.1.4" data-path="repetitive-processes-and-looping.html"><a href="repetitive-processes-and-looping.html#looping-over-multiple-variables-using-lapply"><i class="fa fa-check"></i><b>A.1.4</b> Looping over multiple variables using lapply()</a></li>
<li class="chapter" data-level="A.1.5" data-path="repetitive-processes-and-looping.html"><a href="repetitive-processes-and-looping.html#do-you-really-need-to-loop"><i class="fa fa-check"></i><b>A.1.5</b> Do you really need to loop?</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="parcomp.html"><a href="parcomp.html"><i class="fa fa-check"></i><b>A.2</b> Parallelization of embarrassingly parallel processes</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="parcomp.html"><a href="parcomp.html#mac-or-linux-users"><i class="fa fa-check"></i><b>A.2.1</b> Mac or Linux users</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="ggplot2-minimals.html"><a href="ggplot2-minimals.html"><i class="fa fa-check"></i><b>B</b> ggplot2 minimals</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R as GIS for Economists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<link href="style.css" rel="stylesheet" type="text/css">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-59758608-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-59758608-3');
</script>

<div id="demonstration-5-groundwater-use-for-agricultural-irrigation" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Demonstration 5: Groundwater use for agricultural irrigation</h2>
<div id="project-overview-4" class="section level3" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> Project Overview</h3>
<hr />
<p><strong>Objective</strong></p>
<ul>
<li>Understand the impact of monthly precipitation on groundwater use for agricultural irrigation</li>
</ul>
<hr />
<p><strong>Datasets</strong></p>
<ul>
<li>Annual groundwater pumping by irrigation wells in Kansas for 2010 and 2011 (originally obtained from the Water Information Management &amp; Analysis System (WIMAS) database)</li>
<li>Daymet<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a> daily precipitation and maximum temperature downloaded using <code>daymetr</code> package</li>
</ul>
<hr />
<p><strong>Econometric Model</strong></p>
<p>The econometric model we would like to estimate is:</p>
<p><span class="math display">\[
   y_{i,t}  = \alpha +  P_{i,t} \beta + T_{i,t} \gamma + \phi_i + \eta_t + v_{i,t}
\]</span></p>
<p>where <span class="math inline">\(y\)</span> is the total groundwater extracted in year <span class="math inline">\(t\)</span>, <span class="math inline">\(P_{i,t}\)</span> and <span class="math inline">\(T_{i,t}\)</span> is the collection of monthly total precipitation and mean maximum temperature April through September in year <span class="math inline">\(t\)</span>, respectively, <span class="math inline">\(\phi_i\)</span> is the well fixed effect, <span class="math inline">\(\eta_t\)</span> is the year fixed effect, and <span class="math inline">\(v_{i,t}\)</span> is the error term.</p>
<hr />
<p><strong>GIS tasks</strong></p>
<ul>
<li>download Daymet precipitation and maximum temperature data for each well from within R in parallel
<ul>
<li>use <code>daymetr::download_daymet()</code> and <code>future.apply::future_lapply()</code></li>
</ul></li>
</ul>
<hr />
<p><strong>Preparation for replication</strong></p>
<ul>
<li>Run the following code to install or load (if already installed) the <code>pacman</code> package, and then install or load (if already installed) the listed package inside the <code>pacman::p_load()</code> function.</li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;pacman&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;pacman&quot;</span>)</span>
<span id="cb75-2"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb75-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb75-3"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb75-3" aria-hidden="true" tabindex="-1"></a>  daymetr, <span class="co"># get Daymet data</span></span>
<span id="cb75-4"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb75-4" aria-hidden="true" tabindex="-1"></a>  sf, <span class="co"># vector data operations</span></span>
<span id="cb75-5"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb75-5" aria-hidden="true" tabindex="-1"></a>  dplyr, <span class="co"># data wrangling</span></span>
<span id="cb75-6"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb75-6" aria-hidden="true" tabindex="-1"></a>  data.table, <span class="co"># data wrangling</span></span>
<span id="cb75-7"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb75-7" aria-hidden="true" tabindex="-1"></a>  ggplot2, <span class="co"># for map creation</span></span>
<span id="cb75-8"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb75-8" aria-hidden="true" tabindex="-1"></a>  RhpcBLASctl, <span class="co"># to get the number of available cores</span></span>
<span id="cb75-9"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb75-9" aria-hidden="true" tabindex="-1"></a>  future.apply, <span class="co"># parallelization</span></span>
<span id="cb75-10"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb75-10" aria-hidden="true" tabindex="-1"></a>  lfe, <span class="co"># fast regression with many fixed effects</span></span>
<span id="cb75-11"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb75-11" aria-hidden="true" tabindex="-1"></a>  modelsummary <span class="co"># regression table generation</span></span>
<span id="cb75-12"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb75-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="project-demonstration-4" class="section level3" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> Project Demonstration</h3>
<p>We have already collected annual groundwater pumping data by irrigation wells in 2010 and 2011 in Kansas from the Water Information Management &amp; Analysis System (WIMAS) database. Let’s read in the groundwater use data.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- read in the data ---#</span></span>
<span id="cb76-2"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb76-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb76-3"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb76-3" aria-hidden="true" tabindex="-1"></a>gw_KS_sf <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;Data/gw_KS_sf.rds&quot;</span>)</span>
<span id="cb76-4"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb76-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>Simple feature collection with 56225 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -102.0495 ymin: 36.99561 xmax: -94.70746 ymax: 40.00191
Geodetic CRS:  NAD83
First 10 features:
   well_id year   af_used                   geometry
1        1 2010  67.00000 POINT (-100.4423 37.52046)
2        1 2011 171.00000 POINT (-100.4423 37.52046)
3        3 2010  30.93438 POINT (-100.7118 39.91526)
4        3 2011  12.00000 POINT (-100.7118 39.91526)
5        7 2010   0.00000 POINT (-101.8995 38.78077)
6        7 2011   0.00000 POINT (-101.8995 38.78077)
7       11 2010 154.00000 POINT (-101.7114 39.55035)
8       11 2011 160.00000 POINT (-101.7114 39.55035)
9       12 2010  28.17239 POINT (-95.97031 39.16121)
10      12 2011  89.53479 POINT (-95.97031 39.16121)</code></pre>
<p>We have 28553 wells in total, and each well has records of groundwater pumping (<code>af_used</code>) for years 2010 and 2011. Here is the spatial distribution of the wells.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb78-1" aria-hidden="true" tabindex="-1"></a>KS_counties <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;Data/KS_county_borders.rds&quot;</span>)</span>
<span id="cb78-2"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(KS_counties) <span class="sc">+</span></span>
<span id="cb78-4"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb78-5"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(gw_KS_sf) <span class="sc">+</span></span>
<span id="cb78-6"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_symbols</span>(<span class="at">size =</span> <span class="fl">0.05</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="R_GIS_Book_files/figure-html/Demo5_map-1.png" width="672" /></p>
<!-- 
#=========================================
# Daymet data download and processing 
#=========================================
-->
<hr />
<p>We now need to get monthly precipitation and maximum temperature data. We have decided that we use <a href="https://daymet.ornl.gov/">Daymet</a> weather data. Here we use the <code>download_daymet()</code> function from the <code>daymetr</code> package<a href="#fn25" class="footnote-ref" id="fnref25"><sup>25</sup></a> that allows us to download all the weather variables for a specified geographic location and time period<a href="#fn26" class="footnote-ref" id="fnref26"><sup>26</sup></a>. We write a wrapper function that downloads Daymet data and then processes it to find monthly total precipitation and mean maximum temperature<a href="#fn27" class="footnote-ref" id="fnref27"><sup>27</sup></a>. We then loop over the 56225 wells, which is parallelized using the <code>future_apply()</code> function<a href="#fn28" class="footnote-ref" id="fnref28"><sup>28</sup></a> from the <code>future.apply</code> package. This process takes about an hour on my Mac with parallelization on 7 cores. The data is available in the data repository for this course (named as “all_daymet.rds”).</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- get the geographic coordinates of the wells ---#</span></span>
<span id="cb79-2"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-2" aria-hidden="true" tabindex="-1"></a>well_locations <span class="ot">&lt;-</span> </span>
<span id="cb79-3"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-3" aria-hidden="true" tabindex="-1"></a>  gw_KS_sf <span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(<span class="at">by =</span> <span class="st">&quot;well_id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-5"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(well_id) <span class="sc">%&gt;%</span></span>
<span id="cb79-6"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(., <span class="fu">st_coordinates</span>(.))</span>
<span id="cb79-7"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co">#--- define a function that downloads Daymet data by well and process it ---#</span></span>
<span id="cb79-9"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-9" aria-hidden="true" tabindex="-1"></a>get_daymet <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb79-10"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-10" aria-hidden="true" tabindex="-1"></a>  temp_site <span class="ot">&lt;-</span> well_locations[i, ]<span class="sc">$</span>well_id</span>
<span id="cb79-11"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-11" aria-hidden="true" tabindex="-1"></a>  temp_long <span class="ot">&lt;-</span> well_locations[i, ]<span class="sc">$</span>X</span>
<span id="cb79-12"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-12" aria-hidden="true" tabindex="-1"></a>  temp_lat <span class="ot">&lt;-</span> well_locations[i, ]<span class="sc">$</span>Y</span>
<span id="cb79-13"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-14"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-14" aria-hidden="true" tabindex="-1"></a>  data_temp <span class="ot">&lt;-</span> </span>
<span id="cb79-15"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">download_daymet</span>(</span>
<span id="cb79-16"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">site =</span> temp_site,</span>
<span id="cb79-17"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">lat =</span> temp_lat,</span>
<span id="cb79-18"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">lon =</span> temp_long,</span>
<span id="cb79-19"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">start =</span> <span class="dv">2010</span>,</span>
<span id="cb79-20"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">end =</span> <span class="dv">2011</span>,</span>
<span id="cb79-21"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-21" aria-hidden="true" tabindex="-1"></a>      <span class="co">#--- if TRUE, tidy data is returned ---#</span></span>
<span id="cb79-22"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">simplify =</span> <span class="cn">TRUE</span>,</span>
<span id="cb79-23"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-23" aria-hidden="true" tabindex="-1"></a>      <span class="co">#--- if TRUE, the downloaded data can be assigned to an R object ---#</span></span>
<span id="cb79-24"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">internal =</span> <span class="cn">TRUE</span></span>
<span id="cb79-25"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb79-26"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-27"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">#--- keep only precip and tmax ---#</span></span>
<span id="cb79-28"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-28" aria-hidden="true" tabindex="-1"></a>    .[measurement <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;prcp..mm.day.&quot;</span>, <span class="st">&quot;tmax..deg.c.&quot;</span>), ] <span class="sc">%&gt;%</span></span>
<span id="cb79-29"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">#--- recover calender date from Julian day ---#</span></span>
<span id="cb79-30"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-30" aria-hidden="true" tabindex="-1"></a>    .[, date <span class="sc">:</span><span class="er">=</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(year, yday, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>), <span class="st">&quot;%Y-%j&quot;</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb79-31"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">#--- get month ---#</span></span>
<span id="cb79-32"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-32" aria-hidden="true" tabindex="-1"></a>    .[, month <span class="sc">:</span><span class="er">=</span> <span class="fu">month</span>(date)] <span class="sc">%&gt;%</span></span>
<span id="cb79-33"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">#--- keep only April through September ---#</span></span>
<span id="cb79-34"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-34" aria-hidden="true" tabindex="-1"></a>    .[month <span class="sc">%in%</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">9</span>, ] <span class="sc">%&gt;%</span></span>
<span id="cb79-35"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-35" aria-hidden="true" tabindex="-1"></a>    .[, .(site, year, month, date, measurement, value)] <span class="sc">%&gt;%</span></span>
<span id="cb79-36"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">#--- long to wide ---#</span></span>
<span id="cb79-37"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dcast</span>(site <span class="sc">+</span> year <span class="sc">+</span> month <span class="sc">+</span> date <span class="sc">~</span> measurement, <span class="at">value.var =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-38"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-38" aria-hidden="true" tabindex="-1"></a>    <span class="co">#--- change variable names ---#</span></span>
<span id="cb79-39"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setnames</span>(<span class="fu">c</span>(<span class="st">&quot;prcp..mm.day.&quot;</span>, <span class="st">&quot;tmax..deg.c.&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;prcp&quot;</span>, <span class="st">&quot;tmax&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb79-40"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">#--- find the total precip and mean tmax by month-year ---#</span></span>
<span id="cb79-41"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-41" aria-hidden="true" tabindex="-1"></a>    .[, .(<span class="at">prcp =</span> <span class="fu">sum</span>(prcp), <span class="at">tmax =</span> <span class="fu">mean</span>(tmax)), by <span class="ot">=</span> .(month, year)] <span class="sc">%&gt;%</span></span>
<span id="cb79-42"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-42" aria-hidden="true" tabindex="-1"></a>    .[, well_id <span class="sc">:</span><span class="er">=</span> temp_site]</span>
<span id="cb79-43"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-44"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data_temp)</span>
<span id="cb79-45"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gc</span>()</span>
<span id="cb79-46"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb79-46" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here is what one run (for the first well) of <code>get_daymet()</code> returns</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- one run ---#</span></span>
<span id="cb80-2"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb80-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb80-3"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb80-3" aria-hidden="true" tabindex="-1"></a>returned_data <span class="ot">&lt;-</span> <span class="fu">get_daymet</span>(<span class="dv">1</span>)[]</span>
<span id="cb80-4"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb80-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>    month year  prcp     tmax well_id
 1:     4 2010 40.72 20.71700       1
 2:     5 2010 93.60 24.41677       1
 3:     6 2010 70.45 32.59933       1
 4:     7 2010 84.58 33.59903       1
 5:     8 2010 66.41 34.17323       1
 6:     9 2010 15.58 31.25800       1
 7:     4 2011 24.04 21.86367       1
 8:     5 2011 25.59 26.51097       1
 9:     6 2011 23.15 35.37533       1
10:     7 2011 35.10 38.60548       1
11:     8 2011 36.66 36.94871       1
12:     9 2011  9.59 28.31800       1</code></pre>
<p>We get the number of cores you can use by <code>RhpcBLASctl::get_num_procs()</code> and parallelize the loop over wells using <code>future_lapply()</code>.<a href="#fn29" class="footnote-ref" id="fnref29"><sup>29</sup></a></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- prepare for parallelization ---#</span></span>
<span id="cb82-2"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb82-2" aria-hidden="true" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="fu">get_num_procs</span>() <span class="sc">-</span> <span class="dv">1</span> <span class="co"># number of cores</span></span>
<span id="cb82-3"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multiprocess, <span class="at">workers =</span> num_cores) <span class="co"># set up cores</span></span>
<span id="cb82-4"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co">#--- run get_daymet with parallelization ---#</span></span>
<span id="cb82-6"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb82-6" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb82-7"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb82-7" aria-hidden="true" tabindex="-1"></a>all_daymet <span class="ot">&lt;-</span> </span>
<span id="cb82-8"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">future_lapply</span>(</span>
<span id="cb82-9"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(well_locations), </span>
<span id="cb82-10"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb82-10" aria-hidden="true" tabindex="-1"></a>    get_daymet</span>
<span id="cb82-11"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb82-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb82-12"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb82-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbindlist</span>()</span>
<span id="cb82-13"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb82-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>        month year prcp     tmax well_id
     1:     4 2010   42 20.96667       1
     2:     5 2010   94 24.19355       1
     3:     6 2010   70 32.51667       1
     4:     7 2010   89 33.50000       1
     5:     8 2010   63 34.17742       1
    ---                                 
336980:     5 2011   18 26.11290   78051
336981:     6 2011   25 34.61667   78051
336982:     7 2011    6 38.37097   78051
336983:     8 2011   39 36.66129   78051
336984:     9 2011   23 28.45000   78051</code></pre>
<hr />
<p>Before merging the Daymet data, we need to reshape the data into a wide format to get monthly precipitation and maximum temperature as columns.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- long to wide ---#</span></span>
<span id="cb84-2"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb84-2" aria-hidden="true" tabindex="-1"></a>daymet_to_merge <span class="ot">&lt;-</span> </span>
<span id="cb84-3"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb84-3" aria-hidden="true" tabindex="-1"></a>  all_daymet <span class="sc">%&gt;%</span> </span>
<span id="cb84-4"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dcast</span>(</span>
<span id="cb84-5"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb84-5" aria-hidden="true" tabindex="-1"></a>    well_id <span class="sc">+</span> year <span class="sc">~</span> month, </span>
<span id="cb84-6"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">value.var =</span> <span class="fu">c</span>(<span class="st">&quot;prcp&quot;</span>, <span class="st">&quot;tmax&quot;</span>)</span>
<span id="cb84-7"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb84-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb84-8"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="co">#--- take a look ---#</span></span>
<span id="cb84-10"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb84-10" aria-hidden="true" tabindex="-1"></a>daymet_to_merge</span></code></pre></div>
<pre><code>       well_id year prcp_4 prcp_5 prcp_6 prcp_7 prcp_8 prcp_9   tmax_4   tmax_5
    1:       1 2010     42     94     70     89     63     15 20.96667 24.19355
    2:       1 2011     25     26     23     35     37      9 21.91667 26.30645
    3:       3 2010     85     62    109    112     83     41 19.93333 21.64516
    4:       3 2011     80    104     44    124    118     14 18.40000 22.62903
    5:       7 2010     44     83     23     99    105     13 18.81667 22.14516
   ---                                                                         
56160:   78049 2011     27      6     38     37     34     36 22.81667 26.70968
56161:   78050 2010     35     48     68    111     56      9 21.38333 24.85484
56162:   78050 2011     26      7     44     38     34     35 22.76667 26.70968
56163:   78051 2010     30     62     48     29     76      3 21.05000 24.14516
56164:   78051 2011     33     18     25      6     39     23 21.90000 26.11290
         tmax_6   tmax_7   tmax_8   tmax_9
    1: 32.51667 33.50000 34.17742 31.43333
    2: 35.16667 38.62903 36.90323 28.66667
    3: 30.73333 32.80645 33.56452 28.93333
    4: 30.08333 35.08065 32.90323 25.81667
    5: 31.30000 33.12903 32.67742 30.16667
   ---                                    
56160: 35.01667 38.32258 36.54839 28.80000
56161: 33.16667 33.88710 34.40323 32.11667
56162: 34.91667 38.32258 36.54839 28.83333
56163: 32.90000 33.83871 34.38710 31.56667
56164: 34.61667 38.37097 36.66129 28.45000</code></pre>
<p>Now, let’s merge the weather data to the groundwater pumping dataset.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb86-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb86-2"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb86-2" aria-hidden="true" tabindex="-1"></a>reg_data <span class="ot">&lt;-</span> </span>
<span id="cb86-3"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>(gw_KS_sf) <span class="sc">%&gt;%</span></span>
<span id="cb86-4"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#--- keep only the relevant variables ---#</span></span>
<span id="cb86-5"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb86-5" aria-hidden="true" tabindex="-1"></a>  .[, .(well_id, year, af_used)] <span class="sc">%&gt;%</span></span>
<span id="cb86-6"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#--- join ---#</span></span>
<span id="cb86-7"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb86-7" aria-hidden="true" tabindex="-1"></a>  daymet_to_merge[., <span class="at">on =</span> <span class="fu">c</span>(<span class="st">&quot;well_id&quot;</span>, <span class="st">&quot;year&quot;</span>)]</span>
<span id="cb86-8"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb86-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>       well_id year prcp_4 prcp_5 prcp_6 prcp_7 prcp_8 prcp_9   tmax_4   tmax_5
    1:       1 2010     42     94     70     89     63     15 20.96667 24.19355
    2:       1 2011     25     26     23     35     37      9 21.91667 26.30645
    3:       3 2010     85     62    109    112     83     41 19.93333 21.64516
    4:       3 2011     80    104     44    124    118     14 18.40000 22.62903
    5:       7 2010     44     83     23     99    105     13 18.81667 22.14516
   ---                                                                         
56221:   79348 2011     NA     NA     NA     NA     NA     NA       NA       NA
56222:   79349 2011     NA     NA     NA     NA     NA     NA       NA       NA
56223:   79367 2011     NA     NA     NA     NA     NA     NA       NA       NA
56224:   79372 2011     NA     NA     NA     NA     NA     NA       NA       NA
56225:   80930 2011     NA     NA     NA     NA     NA     NA       NA       NA
         tmax_6   tmax_7   tmax_8   tmax_9   af_used
    1: 32.51667 33.50000 34.17742 31.43333  67.00000
    2: 35.16667 38.62903 36.90323 28.66667 171.00000
    3: 30.73333 32.80645 33.56452 28.93333  30.93438
    4: 30.08333 35.08065 32.90323 25.81667  12.00000
    5: 31.30000 33.12903 32.67742 30.16667   0.00000
   ---                                              
56221:       NA       NA       NA       NA  76.00000
56222:       NA       NA       NA       NA 182.00000
56223:       NA       NA       NA       NA   0.00000
56224:       NA       NA       NA       NA 134.00000
56225:       NA       NA       NA       NA  23.69150</code></pre>
<hr />
<p>Let’s run regression and display the results.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- run FE ---#</span></span>
<span id="cb88-2"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-2" aria-hidden="true" tabindex="-1"></a>reg_results <span class="ot">&lt;-</span> </span>
<span id="cb88-3"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-3" aria-hidden="true" tabindex="-1"></a>  fixest<span class="sc">::</span><span class="fu">feols</span>(</span>
<span id="cb88-4"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-4" aria-hidden="true" tabindex="-1"></a>  af_used <span class="sc">~</span> <span class="co"># dependent variable</span></span>
<span id="cb88-5"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-5" aria-hidden="true" tabindex="-1"></a>  prcp_4 <span class="sc">+</span> prcp_5 <span class="sc">+</span> prcp_6 <span class="sc">+</span> prcp_7 <span class="sc">+</span> prcp_8 <span class="sc">+</span> prcp_9 </span>
<span id="cb88-6"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span> tmax_4 <span class="sc">+</span> tmax_5 <span class="sc">+</span> tmax_6 <span class="sc">+</span> tmax_7 <span class="sc">+</span> tmax_8 <span class="sc">+</span> tmax_9</span>
<span id="cb88-7"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span> well_id <span class="sc">+</span> year, <span class="co"># FEs</span></span>
<span id="cb88-8"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster =</span> <span class="st">&quot;well_id&quot;</span>, </span>
<span id="cb88-9"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> reg_data</span>
<span id="cb88-10"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-11"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co">#--- display regression results ---#</span></span>
<span id="cb88-13"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-13" aria-hidden="true" tabindex="-1"></a>modelsummary<span class="sc">::</span><span class="fu">modelsummary</span>(</span>
<span id="cb88-14"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-14" aria-hidden="true" tabindex="-1"></a>  reg_results,</span>
<span id="cb88-15"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb88-16"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">&quot;IC|Log|Adj|Within|Pseudo&quot;</span></span>
<span id="cb88-17"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#cb88-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Model 1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
prcp_4
</td>
<td style="text-align:left;">
-0.053***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.017)
</td>
</tr>
<tr>
<td style="text-align:left;">
prcp_5
</td>
<td style="text-align:left;">
0.112***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.010)
</td>
</tr>
<tr>
<td style="text-align:left;">
prcp_6
</td>
<td style="text-align:left;">
-0.073***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.008)
</td>
</tr>
<tr>
<td style="text-align:left;">
prcp_7
</td>
<td style="text-align:left;">
0.014
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.010)
</td>
</tr>
<tr>
<td style="text-align:left;">
prcp_8
</td>
<td style="text-align:left;">
0.093***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.014)
</td>
</tr>
<tr>
<td style="text-align:left;">
prcp_9
</td>
<td style="text-align:left;">
-0.177***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.025)
</td>
</tr>
<tr>
<td style="text-align:left;">
tmax_4
</td>
<td style="text-align:left;">
9.159***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(1.227)
</td>
</tr>
<tr>
<td style="text-align:left;">
tmax_5
</td>
<td style="text-align:left;">
-7.505***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(1.062)
</td>
</tr>
<tr>
<td style="text-align:left;">
tmax_6
</td>
<td style="text-align:left;">
15.134***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(1.360)
</td>
</tr>
<tr>
<td style="text-align:left;">
tmax_7
</td>
<td style="text-align:left;">
3.969**
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(1.618)
</td>
</tr>
<tr>
<td style="text-align:left;">
tmax_8
</td>
<td style="text-align:left;">
3.420***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(1.066)
</td>
</tr>
<tr>
<td style="text-align:left;">
tmax_9
</td>
<td style="text-align:left;">
-11.803***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(1.801)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:left;">
55754
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:left;">
0.942
</td>
</tr>
<tr>
<td style="text-align:left;">
FE: well_id
</td>
<td style="text-align:left;">
X
</td>
</tr>
<tr>
<td style="text-align:left;">
FE: year
</td>
<td style="text-align:left;">
X
</td>
</tr>
<tr>
<td style="text-align:left;">
Std. errors
</td>
<td style="text-align:left;">
Clustered (well_id)
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup></sup> * p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01
</td>
</tr>
</tfoot>
</table>
<p>That’s it. Do not bother to try to read into the regression results. Again, this is just an illustration of how R can be used to prepare a regression-ready dataset with spatial variables.</p>

</div>
</div>
<!-- </div> -->



<div class="footnotes">
<hr />
<ol start="24">
<li id="fn24"><p><a href="https://daymet.ornl.gov/">Daymet website</a><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#fnref24" class="footnote-back">↩︎</a></p></li>
<li id="fn25"><p><a href="https://cran.r-project.org/web/packages/daymetr/vignettes/daymetr-vignette.html">daymetr vignette</a><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#fnref25" class="footnote-back">↩︎</a></p></li>
<li id="fn26"><p>See <a href="">here</a> for a fuller explanation of how to use the <code>daymetr</code> package.<a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#fnref26" class="footnote-back">↩︎</a></p></li>
<li id="fn27"><p>This may not be ideal for a real research project because the original raw data is not kept. It is often the case that your econometric plan changes on the course of your project (e.g., using other weather variables or using different temporal aggregation of weather variables instead of monthly aggregation). When this happens, you need to download the same data all over again.<a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#fnref27" class="footnote-back">↩︎</a></p></li>
<li id="fn28"><p>For parallelized computation, see Chapter <a href="par-comp.html#par-comp">A</a><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#fnref28" class="footnote-back">↩︎</a></p></li>
<li id="fn29"><p>For Mac users, <code>mclapply</code> or <code>pbmclapply</code> (<code>mclapply</code> with progress bar) are good alternatives.<a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#fnref29" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="demo4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="vector-basics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"toc_depth": 3,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
