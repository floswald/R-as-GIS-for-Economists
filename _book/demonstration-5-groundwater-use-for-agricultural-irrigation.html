<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.5 Demonstration 5: Groundwater use for agricultural irrigation | R as GIS for Economists</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="1.5 Demonstration 5: Groundwater use for agricultural irrigation | R as GIS for Economists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.5 Demonstration 5: Groundwater use for agricultural irrigation | R as GIS for Economists" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Taro Mieno" />


<meta name="date" content="2020-05-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="demo4.html"/>
<link rel="next" href="vector-basics.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R as GIS for Economists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="why-r-as-gis-for-economists.html"><a href="why-r-as-gis-for-economists.html"><i class="fa fa-check"></i>Why R as GIS for Economists?</a><ul>
<li class="chapter" data-level="" data-path="why-r-as-gis-for-economists.html"><a href="why-r-as-gis-for-economists.html#r-vs-python"><i class="fa fa-check"></i>R vs Python</a></li>
<li class="chapter" data-level="" data-path="why-r-as-gis-for-economists.html"><a href="why-r-as-gis-for-economists.html#r-vs-arcgis-or-qgis"><i class="fa fa-check"></i>R vs ArcGIS or QGIS</a></li>
<li class="chapter" data-level="" data-path="why-r-as-gis-for-economists.html"><a href="why-r-as-gis-for-economists.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-is-this-book-different-from-other-online-books-and-resources.html"><a href="how-is-this-book-different-from-other-online-books-and-resources.html"><i class="fa fa-check"></i>How is this book different from other online books and resources?</a></li>
<li class="chapter" data-level="" data-path="what-is-going-to-be-covered-in-this-book.html"><a href="what-is-going-to-be-covered-in-this-book.html"><i class="fa fa-check"></i>What is going to be covered in this book?</a></li>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html"><i class="fa fa-check"></i>Conventions of the book and some notes</a><ul>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html#texts-in-gray-boxes"><i class="fa fa-check"></i>Texts in gray boxes</a></li>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html#colored-boxes"><i class="fa fa-check"></i>Colored Boxes</a></li>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html#parentheses-around-codes"><i class="fa fa-check"></i>Parentheses around codes</a></li>
<li class="chapter" data-level="" data-path="conventions-of-the-book-and-some-notes.html"><a href="conventions-of-the-book-and-some-notes.html#footnotes"><i class="fa fa-check"></i>Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="session-information.html"><a href="session-information.html"><i class="fa fa-check"></i>Session Information</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="demo.html"><a href="demo.html"><i class="fa fa-check"></i><b>1</b> R as GIS: Demonstrations</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1.1" data-path="Demo1.html"><a href="Demo1.html"><i class="fa fa-check"></i><b>1.1</b> Demonstration 1: The impact of groundwater pumping on depth to water table</a><ul>
<li class="chapter" data-level="1.1.1" data-path="Demo1.html"><a href="Demo1.html#project-overview"><i class="fa fa-check"></i><b>1.1.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.1.2" data-path="Demo1.html"><a href="Demo1.html#project-demonstration"><i class="fa fa-check"></i><b>1.1.2</b> Project Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="demonstration-2-precision-agriculture.html"><a href="demonstration-2-precision-agriculture.html"><i class="fa fa-check"></i><b>1.2</b> Demonstration 2: Precision Agriculture</a><ul>
<li class="chapter" data-level="1.2.1" data-path="demonstration-2-precision-agriculture.html"><a href="demonstration-2-precision-agriculture.html#project-overview-1"><i class="fa fa-check"></i><b>1.2.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.2.2" data-path="demonstration-2-precision-agriculture.html"><a href="demonstration-2-precision-agriculture.html#project-demonstration-1"><i class="fa fa-check"></i><b>1.2.2</b> Project Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="demonstration-3-land-use-and-weather.html"><a href="demonstration-3-land-use-and-weather.html"><i class="fa fa-check"></i><b>1.3</b> Demonstration 3: Land Use and Weather</a><ul>
<li class="chapter" data-level="1.3.1" data-path="demonstration-3-land-use-and-weather.html"><a href="demonstration-3-land-use-and-weather.html#project-overview-2"><i class="fa fa-check"></i><b>1.3.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.3.2" data-path="demonstration-3-land-use-and-weather.html"><a href="demonstration-3-land-use-and-weather.html#project-demonstration-2"><i class="fa fa-check"></i><b>1.3.2</b> Project Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="demo4.html"><a href="demo4.html"><i class="fa fa-check"></i><b>1.4</b> Demonstration 4: The Impact of Railroad Presence on Corn Planted Acreage</a><ul>
<li class="chapter" data-level="1.4.1" data-path="demo4.html"><a href="demo4.html#project-overview-3"><i class="fa fa-check"></i><b>1.4.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.4.2" data-path="demo4.html"><a href="demo4.html#project-demonstration-3"><i class="fa fa-check"></i><b>1.4.2</b> Project Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="demonstration-5-groundwater-use-for-agricultural-irrigation.html"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html"><i class="fa fa-check"></i><b>1.5</b> Demonstration 5: Groundwater use for agricultural irrigation</a><ul>
<li class="chapter" data-level="1.5.1" data-path="demonstration-5-groundwater-use-for-agricultural-irrigation.html"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#project-overview-4"><i class="fa fa-check"></i><b>1.5.1</b> Project Overview</a></li>
<li class="chapter" data-level="1.5.2" data-path="demonstration-5-groundwater-use-for-agricultural-irrigation.html"><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#project-demonstration-4"><i class="fa fa-check"></i><b>1.5.2</b> Project Demonstration</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="vector-basics.html"><a href="vector-basics.html"><i class="fa fa-check"></i><b>2</b> Handle vector data using the sf package</a><ul>
<li class="chapter" data-level="" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="2.1" data-path="spatial-data-structure.html"><a href="spatial-data-structure.html"><i class="fa fa-check"></i><b>2.1</b> Spatial Data Structure</a></li>
<li class="chapter" data-level="2.2" data-path="simple-feature-geometry-simple-feature-geometry-list-column-and-simple-feature.html"><a href="simple-feature-geometry-simple-feature-geometry-list-column-and-simple-feature.html"><i class="fa fa-check"></i><b>2.2</b> Simple feature geometry, simple feature geometry list-column, and simple feature</a><ul>
<li class="chapter" data-level="2.2.1" data-path="simple-feature-geometry-simple-feature-geometry-list-column-and-simple-feature.html"><a href="simple-feature-geometry-simple-feature-geometry-list-column-and-simple-feature.html#simple-feature-geometry-sfg"><i class="fa fa-check"></i><b>2.2.1</b> Simple feature geometry (<code>sfg</code>)</a></li>
<li class="chapter" data-level="2.2.2" data-path="simple-feature-geometry-simple-feature-geometry-list-column-and-simple-feature.html"><a href="simple-feature-geometry-simple-feature-geometry-list-column-and-simple-feature.html#create-simple-feature-geometry-list-column-sfc-and-simple-feature-sf-from-scratch"><i class="fa fa-check"></i><b>2.2.2</b> Create simple feature geometry list-column (<code>sfc</code>) and simple feature (<code>sf</code>) from scratch</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="reading-and-writing-vector-data.html"><a href="reading-and-writing-vector-data.html"><i class="fa fa-check"></i><b>2.3</b> Reading and writing vector data</a><ul>
<li class="chapter" data-level="2.3.1" data-path="reading-and-writing-vector-data.html"><a href="reading-and-writing-vector-data.html#reading-a-shapefile"><i class="fa fa-check"></i><b>2.3.1</b> Reading a shapefile</a></li>
<li class="chapter" data-level="2.3.2" data-path="reading-and-writing-vector-data.html"><a href="reading-and-writing-vector-data.html#writing-to-a-shapefile"><i class="fa fa-check"></i><b>2.3.2</b> Writing to a shapefile</a></li>
<li class="chapter" data-level="2.3.3" data-path="reading-and-writing-vector-data.html"><a href="reading-and-writing-vector-data.html#better-alternatives"><i class="fa fa-check"></i><b>2.3.3</b> Better alternatives</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="projection-with-a-different-coordinate-reference-systems.html"><a href="projection-with-a-different-coordinate-reference-systems.html"><i class="fa fa-check"></i><b>2.4</b> Projection with a different Coordinate Reference Systems</a></li>
<li class="chapter" data-level="2.5" data-path="non-spatial-transformation-of-sf.html"><a href="non-spatial-transformation-of-sf.html"><i class="fa fa-check"></i><b>2.5</b> Non-spatial transformation of sf</a></li>
<li class="chapter" data-level="2.6" data-path="turning-a-data-frame-of-points-into-an-sf.html"><a href="turning-a-data-frame-of-points-into-an-sf.html"><i class="fa fa-check"></i><b>2.6</b> Turning a data.frame of points into an <code>sf</code></a></li>
<li class="chapter" data-level="2.7" data-path="conversion-to-and-from-sp.html"><a href="conversion-to-and-from-sp.html"><i class="fa fa-check"></i><b>2.7</b> Conversion to and from sp</a></li>
<li class="chapter" data-level="2.8" data-path="geometrical-operations.html"><a href="geometrical-operations.html"><i class="fa fa-check"></i><b>2.8</b> Geometrical operations</a><ul>
<li class="chapter" data-level="2.8.1" data-path="geometrical-operations.html"><a href="geometrical-operations.html#st_buffer"><i class="fa fa-check"></i><b>2.8.1</b> st_buffer</a></li>
<li class="chapter" data-level="2.8.2" data-path="geometrical-operations.html"><a href="geometrical-operations.html#st_area"><i class="fa fa-check"></i><b>2.8.2</b> st_area</a></li>
<li class="chapter" data-level="2.8.3" data-path="geometrical-operations.html"><a href="geometrical-operations.html#st_centroid"><i class="fa fa-check"></i><b>2.8.3</b> st_centroid</a></li>
<li class="chapter" data-level="2.8.4" data-path="geometrical-operations.html"><a href="geometrical-operations.html#st_length"><i class="fa fa-check"></i><b>2.8.4</b> st_length</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spatial-interactions-of-vector-data-subsetting-and-joining.html"><a href="spatial-interactions-of-vector-data-subsetting-and-joining.html"><i class="fa fa-check"></i><b>3</b> Spatial Interactions of Vector Data: Subsetting and Joining</a><ul>
<li class="chapter" data-level="3.1" data-path="topological-relations.html"><a href="topological-relations.html"><i class="fa fa-check"></i><b>3.1</b> Topological relations</a><ul>
<li class="chapter" data-level="3.1.1" data-path="topological-relations.html"><a href="topological-relations.html#st_intersects"><i class="fa fa-check"></i><b>3.1.1</b> st_intersects()</a></li>
<li class="chapter" data-level="3.1.2" data-path="topological-relations.html"><a href="topological-relations.html#st_intersection"><i class="fa fa-check"></i><b>3.1.2</b> st_intersection()</a></li>
<li class="chapter" data-level="3.1.3" data-path="topological-relations.html"><a href="topological-relations.html#st_is_within_distance"><i class="fa fa-check"></i><b>3.1.3</b> st_is_within_distance()</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="spatial-subsetting-or-flagging.html"><a href="spatial-subsetting-or-flagging.html"><i class="fa fa-check"></i><b>3.2</b> Spatial Subsetting (or Flagging)</a><ul>
<li class="chapter" data-level="3.2.1" data-path="spatial-subsetting-or-flagging.html"><a href="spatial-subsetting-or-flagging.html#polygons-vs-polygons"><i class="fa fa-check"></i><b>3.2.1</b> polygons vs polygons</a></li>
<li class="chapter" data-level="3.2.2" data-path="spatial-subsetting-or-flagging.html"><a href="spatial-subsetting-or-flagging.html#points-vs-polygons"><i class="fa fa-check"></i><b>3.2.2</b> points vs polygons</a></li>
<li class="chapter" data-level="3.2.3" data-path="spatial-subsetting-or-flagging.html"><a href="spatial-subsetting-or-flagging.html#lines-vs-polygons"><i class="fa fa-check"></i><b>3.2.3</b> lines vs polygons</a></li>
<li class="chapter" data-level="3.2.4" data-path="spatial-subsetting-or-flagging.html"><a href="spatial-subsetting-or-flagging.html#flagging-instead-of-subsetting"><i class="fa fa-check"></i><b>3.2.4</b> Flagging instead of subsetting</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="spatial-join.html"><a href="spatial-join.html"><i class="fa fa-check"></i><b>3.3</b> Spatial Join</a><ul>
<li class="chapter" data-level="3.3.1" data-path="spatial-join.html"><a href="spatial-join.html#case-1-points-target-vs-polygons-source"><i class="fa fa-check"></i><b>3.3.1</b> Case 1: points (target) vs polygons (source)</a></li>
<li class="chapter" data-level="3.3.2" data-path="spatial-join.html"><a href="spatial-join.html#case-2-polygons-target-vs-points-source"><i class="fa fa-check"></i><b>3.3.2</b> Case 2: polygons (target) vs points (source)</a></li>
<li class="chapter" data-level="3.3.3" data-path="spatial-join.html"><a href="spatial-join.html#polygon-polygon"><i class="fa fa-check"></i><b>3.3.3</b> Case 3: polygons (target) vs polygons (source)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R as GIS for Economists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<link href="style.css" rel="stylesheet" type="text/css">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-59758608-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-59758608-3');
</script>
<div id="demonstration-5-groundwater-use-for-agricultural-irrigation" class="section level2">
<h2><span class="header-section-number">1.5</span> Demonstration 5: Groundwater use for agricultural irrigation</h2>
<style>
.book .book-body .page-wrapper .page-inner section.normal table
{
  width:auto;
}
.book .book-body .page-wrapper .page-inner section.normal table td,
.book .book-body .page-wrapper .page-inner section.normal table th,
.book .book-body .page-wrapper .page-inner section.normal table tr
{
  padding:0;
  border:0;
  background-color:#fff;
}
</style>
<div id="project-overview-4" class="section level3">
<h3><span class="header-section-number">1.5.1</span> Project Overview</h3>
<hr />
<p><strong>Objective</strong>
+ Understand the impact of monthly precipitation on groundwater use for agricultural irrigation</p>
<hr />
<p><strong>Datasets</strong></p>
<ul>
<li>Annual groundwater pumping by irrigation wells in Kansas for 2010 and 2011 (originally obtained from the Water Information Management &amp; Analysis System (WIMAS) database)</li>
<li>Daymet<a href="#fn30" class="footnote-ref" id="fnref30"><sup>30</sup></a> daily precipitation and maximum temperature downloaded using <code>daymetr</code> package</li>
</ul>
<hr />
<p><strong>Econometric Model</strong></p>
<p>The econometric model we would like to estimate is:</p>
<p><span class="math display">\[
   y_{i,t}  = \alpha +  P_{i,t} \beta + T_{i,t} \gamma + \phi_i + \eta_t + v_{i,t}
\]</span></p>
<p>where <span class="math inline">\(y\)</span> is the total groundwater extracted in year <span class="math inline">\(t\)</span>, <span class="math inline">\(P_{i,t}\)</span> and <span class="math inline">\(T_{i,t}\)</span> is the collection of monthly total precipitation and mean maximum temperature April through September in year <span class="math inline">\(t\)</span>, respectively, <span class="math inline">\(\phi_i\)</span> is the well fixed effect, <span class="math inline">\(\eta_t\)</span> is the year fixed effect, and <span class="math inline">\(v_{i,t}\)</span> is the error term.</p>
<hr />
<p><strong>GIS tasks</strong></p>
<ul>
<li>download Daymet precipitation and maximum temperature data for each well from within R in parallel
<ul>
<li>use <code>daymetr::download_daymet()</code> and <code>future.apply::future_lapply()</code></li>
</ul></li>
</ul>
<hr />
</div>
<div id="project-demonstration-4" class="section level3">
<h3><span class="header-section-number">1.5.2</span> Project Demonstration</h3>
<p>We have already collected annual groundwater pumping data by irrigation wells in 2010 and 2011 in Kansas from the Water Information Management &amp; Analysis System (WIMAS) database. Let’s read in the groundwater use data.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="co">#--- read in the data ---#</span></a>
<a class="sourceLine" id="cb75-2" data-line-number="2">(</a>
<a class="sourceLine" id="cb75-3" data-line-number="3">gw_KS_sf &lt;-<span class="st"> </span><span class="kw">readRDS</span>( <span class="st">&quot;./Data/gw_KS_sf.rds&quot;</span>) </a>
<a class="sourceLine" id="cb75-4" data-line-number="4">)</a></code></pre></div>
<pre><code>Simple feature collection with 56225 features and 3 fields
geometry type:  POINT
dimension:      XY
bbox:           xmin: -102.0495 ymin: 36.99561 xmax: -94.70746 ymax: 40.00191
CRS:            EPSG:4269
First 10 features:
   well_id year   af_used                   geometry
1        1 2010  67.00000 POINT (-100.4423 37.52046)
2        1 2011 171.00000 POINT (-100.4423 37.52046)
3        3 2010  30.93438 POINT (-100.7118 39.91526)
4        3 2011  12.00000 POINT (-100.7118 39.91526)
5        7 2010   0.00000 POINT (-101.8995 38.78077)
6        7 2011   0.00000 POINT (-101.8995 38.78077)
7       11 2010 154.00000 POINT (-101.7114 39.55035)
8       11 2011 160.00000 POINT (-101.7114 39.55035)
9       12 2010  28.17239 POINT (-95.97031 39.16121)
10      12 2011  89.53479 POINT (-95.97031 39.16121)</code></pre>
<p>We have 28553 wells in total, and each well has records of groundwater pumping (<code>af_used</code>) for years 2010 and 2011. Here is the spatial distribution of the wells.</p>
<p><img src="Demonstration_files/figure-html/Demo5_map-1.png" width="672" /></p>
<!-- 
#=========================================
# Daymet data download and processing 
#=========================================
-->
<hr />
<p>We now need to get monthly precipitation and maximum temperature data. We have decided that we use <a href="https://daymet.ornl.gov/">Daymet</a> weather data. Here we use the <code>download_daymet()</code> function from the <code>daymetr</code> package<a href="#fn31" class="footnote-ref" id="fnref31"><sup>31</sup></a> that allows us to download all the weather variables for a specified geographic location and time period<a href="#fn32" class="footnote-ref" id="fnref32"><sup>32</sup></a>. We write a wrapper function that downloads Daymet data and then processes it to find monthly total precipitation and mean maximum temperature<a href="#fn33" class="footnote-ref" id="fnref33"><sup>33</sup></a>. We then loop over the 56225 wells, which is parallelized using the <code>future_apply()</code> function<a href="#fn34" class="footnote-ref" id="fnref34"><sup>34</sup></a> from the <code>future.apply</code> package. This process takes about an hour on my Mac with parallelization on 7 cores. The data is available in the data repository for this course (named as “all_daymet.rds”).</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw">library</span>(daymetr)</a>
<a class="sourceLine" id="cb77-2" data-line-number="2"><span class="kw">library</span>(future.apply)</a>
<a class="sourceLine" id="cb77-3" data-line-number="3"></a>
<a class="sourceLine" id="cb77-4" data-line-number="4"><span class="co">#--- get the geographic coordinates of the wells ---#</span></a>
<a class="sourceLine" id="cb77-5" data-line-number="5">well_locations &lt;-<span class="st"> </span>gw_KS_sf <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-6" data-line-number="6"><span class="st">  </span><span class="kw">unique</span>(<span class="dt">by =</span> <span class="st">&quot;well_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb77-7" data-line-number="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(well_id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb77-8" data-line-number="8"><span class="st">  </span><span class="kw">cbind</span>(., <span class="kw">st_coordinates</span>(.))</a>
<a class="sourceLine" id="cb77-9" data-line-number="9"></a>
<a class="sourceLine" id="cb77-10" data-line-number="10"><span class="co">#--- define a function that downloads Daymet data by well and process it ---#</span></a>
<a class="sourceLine" id="cb77-11" data-line-number="11">get_daymet &lt;-<span class="st"> </span><span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb77-12" data-line-number="12"></a>
<a class="sourceLine" id="cb77-13" data-line-number="13">  temp_site &lt;-<span class="st"> </span>well_locations[i, ]<span class="op">$</span>well_id</a>
<a class="sourceLine" id="cb77-14" data-line-number="14">  temp_long &lt;-<span class="st"> </span>well_locations[i, ]<span class="op">$</span>X</a>
<a class="sourceLine" id="cb77-15" data-line-number="15">  temp_lat &lt;-<span class="st"> </span>well_locations[i, ]<span class="op">$</span>Y</a>
<a class="sourceLine" id="cb77-16" data-line-number="16"></a>
<a class="sourceLine" id="cb77-17" data-line-number="17">  data_temp &lt;-<span class="st"> </span><span class="kw">download_daymet</span>(</a>
<a class="sourceLine" id="cb77-18" data-line-number="18">      <span class="dt">site =</span> temp_site,</a>
<a class="sourceLine" id="cb77-19" data-line-number="19">      <span class="dt">lat =</span> temp_lat,</a>
<a class="sourceLine" id="cb77-20" data-line-number="20">      <span class="dt">lon =</span> temp_long,</a>
<a class="sourceLine" id="cb77-21" data-line-number="21">      <span class="dt">start =</span> <span class="dv">2010</span>,</a>
<a class="sourceLine" id="cb77-22" data-line-number="22">      <span class="dt">end =</span> <span class="dv">2011</span>,</a>
<a class="sourceLine" id="cb77-23" data-line-number="23">      <span class="co">#--- if TRUE, tidy data is returned ---#</span></a>
<a class="sourceLine" id="cb77-24" data-line-number="24">      <span class="dt">simplify =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb77-25" data-line-number="25">      <span class="co">#--- if TRUE, the downloaded data can be assigned to an R object ---#</span></a>
<a class="sourceLine" id="cb77-26" data-line-number="26">      <span class="dt">internal =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb77-27" data-line-number="27">    ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb77-28" data-line-number="28"><span class="st">    </span><span class="kw">data.table</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb77-29" data-line-number="29"><span class="st">    </span><span class="co">#--- keep only precip and tmax ---#</span></a>
<a class="sourceLine" id="cb77-30" data-line-number="30"><span class="st">    </span>.[measurement <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;prcp..mm.day.&quot;</span>, <span class="st">&quot;tmax..deg.c.&quot;</span>), ] <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb77-31" data-line-number="31"><span class="st">    </span><span class="co">#--- recover calender date from Julian day ---#</span></a>
<a class="sourceLine" id="cb77-32" data-line-number="32"><span class="st">    </span>.[, date <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="kw">paste</span>(year, yday, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>), <span class="st">&quot;%Y-%j&quot;</span>)] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb77-33" data-line-number="33"><span class="st">    </span><span class="co">#--- get month ---#</span></a>
<a class="sourceLine" id="cb77-34" data-line-number="34"><span class="st">    </span>.[, month <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">month</span>(date)] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb77-35" data-line-number="35"><span class="st">    </span><span class="co">#--- keep only April through September ---#</span></a>
<a class="sourceLine" id="cb77-36" data-line-number="36"><span class="st">    </span>.[month <span class="op">%in%</span><span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">9</span>,] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb77-37" data-line-number="37"><span class="st">    </span>.[, .(site, year, month, date, measurement, value)] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb77-38" data-line-number="38"><span class="st">    </span><span class="co">#--- long to wide ---#</span></a>
<a class="sourceLine" id="cb77-39" data-line-number="39"><span class="st">    </span><span class="kw">dcast</span>(site <span class="op">+</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>month <span class="op">+</span><span class="st"> </span>date<span class="op">~</span><span class="st"> </span>measurement, <span class="dt">value.var =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb77-40" data-line-number="40"><span class="st">    </span><span class="co">#--- change variable names ---#</span></a>
<a class="sourceLine" id="cb77-41" data-line-number="41"><span class="st">    </span><span class="kw">setnames</span>(<span class="kw">c</span>(<span class="st">&quot;prcp..mm.day.&quot;</span>, <span class="st">&quot;tmax..deg.c.&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;prcp&quot;</span>, <span class="st">&quot;tmax&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb77-42" data-line-number="42"><span class="st">    </span><span class="co">#--- find the total precip and mean tmax by month-year ---#</span></a>
<a class="sourceLine" id="cb77-43" data-line-number="43"><span class="st">    </span>.[, .(<span class="dt">prcp =</span> <span class="kw">sum</span>(prcp), <span class="dt">tmax =</span> <span class="kw">mean</span>(tmax)) , by =<span class="st"> </span>.(month, year)] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb77-44" data-line-number="44"><span class="st">    </span>.[, well_id <span class="op">:</span><span class="er">=</span><span class="st"> </span>temp_site]</a>
<a class="sourceLine" id="cb77-45" data-line-number="45"></a>
<a class="sourceLine" id="cb77-46" data-line-number="46">  <span class="kw">return</span>(data_temp)</a>
<a class="sourceLine" id="cb77-47" data-line-number="47">  <span class="kw">gc</span>()</a>
<a class="sourceLine" id="cb77-48" data-line-number="48">}</a></code></pre></div>
<p>Here is what one run (for the first well) of <code>get_daymet()</code> returns</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="co">#--- one run ---#</span></a>
<a class="sourceLine" id="cb78-2" data-line-number="2">(</a>
<a class="sourceLine" id="cb78-3" data-line-number="3">returned_data &lt;-<span class="st"> </span><span class="kw">get_daymet</span>(<span class="dv">1</span>)[]</a>
<a class="sourceLine" id="cb78-4" data-line-number="4">)</a></code></pre></div>
<pre><code>    month year prcp     tmax well_id
 1:     4 2010   42 20.96667       1
 2:     5 2010   94 24.19355       1
 3:     6 2010   70 32.51667       1
 4:     7 2010   89 33.50000       1
 5:     8 2010   63 34.17742       1
 6:     9 2010   15 31.43333       1
 7:     4 2011   25 21.91667       1
 8:     5 2011   26 26.30645       1
 9:     6 2011   23 35.16667       1
10:     7 2011   35 38.62903       1
11:     8 2011   37 36.90323       1
12:     9 2011    9 28.66667       1</code></pre>
<p>We get the number of cores you can use by <code>RhpcBLASctl::get_num_procs()</code> and parallelize the loop over wells using <code>future_lapply()</code>.<a href="#fn35" class="footnote-ref" id="fnref35"><sup>35</sup></a></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1"><span class="co">#--- prepare parallelized process ---#</span></a>
<a class="sourceLine" id="cb80-2" data-line-number="2"><span class="kw">library</span>(RhpcBLASctl) </a>
<a class="sourceLine" id="cb80-3" data-line-number="3">num_core &lt;-<span class="st"> </span><span class="kw">get_num_procs</span>() <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb80-4" data-line-number="4"></a>
<a class="sourceLine" id="cb80-5" data-line-number="5"><span class="co">#--- run get_daymet with parallelization ---#</span></a>
<a class="sourceLine" id="cb80-6" data-line-number="6">(</a>
<a class="sourceLine" id="cb80-7" data-line-number="7">all_daymet &lt;-<span class="st"> </span><span class="kw">future_lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(well_locations), get_daymet) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb80-8" data-line-number="8"><span class="st">  </span><span class="kw">rbindlist</span>() </a>
<a class="sourceLine" id="cb80-9" data-line-number="9">)</a></code></pre></div>
<pre><code>        month year prcp     tmax well_id
     1:     4 2010   42 20.96667       1
     2:     5 2010   94 24.19355       1
     3:     6 2010   70 32.51667       1
     4:     7 2010   89 33.50000       1
     5:     8 2010   63 34.17742       1
    ---                                 
336980:     5 2011   18 26.11290   78051
336981:     6 2011   25 34.61667   78051
336982:     7 2011    6 38.37097   78051
336983:     8 2011   39 36.66129   78051
336984:     9 2011   23 28.45000   78051</code></pre>
<hr />
<p>Before merging the Daymet data, we need to reshape the data into a wide format to get monthly precipitation and maximum temperature as columns.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="co">#--- long to wide ---#</span></a>
<a class="sourceLine" id="cb82-2" data-line-number="2">daymet_to_merge &lt;-<span class="st"> </span><span class="kw">dcast</span>(all_daymet, well_id <span class="op">+</span><span class="st"> </span>year <span class="op">~</span><span class="st"> </span>month, <span class="dt">value.var =</span> <span class="kw">c</span>(<span class="st">&quot;prcp&quot;</span>, <span class="st">&quot;tmax&quot;</span>))</a>
<a class="sourceLine" id="cb82-3" data-line-number="3"></a>
<a class="sourceLine" id="cb82-4" data-line-number="4"><span class="co">#--- take a look ---#</span></a>
<a class="sourceLine" id="cb82-5" data-line-number="5">daymet_to_merge</a></code></pre></div>
<pre><code>       well_id year prcp_4 prcp_5 prcp_6 prcp_7 prcp_8 prcp_9   tmax_4   tmax_5
    1:       1 2010     42     94     70     89     63     15 20.96667 24.19355
    2:       1 2011     25     26     23     35     37      9 21.91667 26.30645
    3:       3 2010     85     62    109    112     83     41 19.93333 21.64516
    4:       3 2011     80    104     44    124    118     14 18.40000 22.62903
    5:       7 2010     44     83     23     99    105     13 18.81667 22.14516
   ---                                                                         
56160:   78049 2011     27      6     38     37     34     36 22.81667 26.70968
56161:   78050 2010     35     48     68    111     56      9 21.38333 24.85484
56162:   78050 2011     26      7     44     38     34     35 22.76667 26.70968
56163:   78051 2010     30     62     48     29     76      3 21.05000 24.14516
56164:   78051 2011     33     18     25      6     39     23 21.90000 26.11290
         tmax_6   tmax_7   tmax_8   tmax_9
    1: 32.51667 33.50000 34.17742 31.43333
    2: 35.16667 38.62903 36.90323 28.66667
    3: 30.73333 32.80645 33.56452 28.93333
    4: 30.08333 35.08065 32.90323 25.81667
    5: 31.30000 33.12903 32.67742 30.16667
   ---                                    
56160: 35.01667 38.32258 36.54839 28.80000
56161: 33.16667 33.88710 34.40323 32.11667
56162: 34.91667 38.32258 36.54839 28.83333
56163: 32.90000 33.83871 34.38710 31.56667
56164: 34.61667 38.37097 36.66129 28.45000</code></pre>
<p>Now, let’s merge the weather data to the groundwater pumping dataset.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">(</a>
<a class="sourceLine" id="cb84-2" data-line-number="2">reg_data &lt;-<span class="st"> </span><span class="kw">data.table</span>(gw_KS_sf) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-3" data-line-number="3"><span class="st">  </span><span class="co">#--- keep only the relevant variables ---#</span></a>
<a class="sourceLine" id="cb84-4" data-line-number="4"><span class="st">  </span>.[, .(well_id, year, af_used)] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-5" data-line-number="5"><span class="st">  </span><span class="co">#--- join ---#</span></a>
<a class="sourceLine" id="cb84-6" data-line-number="6"><span class="st">  </span>daymet_to_merge[., <span class="dt">on =</span> <span class="kw">c</span>(<span class="st">&quot;well_id&quot;</span>, <span class="st">&quot;year&quot;</span>)]</a>
<a class="sourceLine" id="cb84-7" data-line-number="7">)</a></code></pre></div>
<pre><code>       well_id year prcp_4 prcp_5 prcp_6 prcp_7 prcp_8 prcp_9   tmax_4   tmax_5
    1:       1 2010     42     94     70     89     63     15 20.96667 24.19355
    2:       1 2011     25     26     23     35     37      9 21.91667 26.30645
    3:       3 2010     85     62    109    112     83     41 19.93333 21.64516
    4:       3 2011     80    104     44    124    118     14 18.40000 22.62903
    5:       7 2010     44     83     23     99    105     13 18.81667 22.14516
   ---                                                                         
56221:   79348 2011     NA     NA     NA     NA     NA     NA       NA       NA
56222:   79349 2011     NA     NA     NA     NA     NA     NA       NA       NA
56223:   79367 2011     NA     NA     NA     NA     NA     NA       NA       NA
56224:   79372 2011     NA     NA     NA     NA     NA     NA       NA       NA
56225:   80930 2011     NA     NA     NA     NA     NA     NA       NA       NA
         tmax_6   tmax_7   tmax_8   tmax_9   af_used
    1: 32.51667 33.50000 34.17742 31.43333  67.00000
    2: 35.16667 38.62903 36.90323 28.66667 171.00000
    3: 30.73333 32.80645 33.56452 28.93333  30.93438
    4: 30.08333 35.08065 32.90323 25.81667  12.00000
    5: 31.30000 33.12903 32.67742 30.16667   0.00000
   ---                                              
56221:       NA       NA       NA       NA  76.00000
56222:       NA       NA       NA       NA 182.00000
56223:       NA       NA       NA       NA   0.00000
56224:       NA       NA       NA       NA 134.00000
56225:       NA       NA       NA       NA  23.69150</code></pre>
<hr />
<p>Let’s run regression and display the results.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1"><span class="co">#--- load lfe package ---#</span></a>
<a class="sourceLine" id="cb86-2" data-line-number="2"><span class="kw">library</span>(lfe)</a>
<a class="sourceLine" id="cb86-3" data-line-number="3"></a>
<a class="sourceLine" id="cb86-4" data-line-number="4"><span class="co">#--- run FE ---#</span></a>
<a class="sourceLine" id="cb86-5" data-line-number="5">reg_results &lt;-<span class="st"> </span><span class="kw">felm</span>(</a>
<a class="sourceLine" id="cb86-6" data-line-number="6">  af_used <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-7" data-line-number="7"><span class="st">  </span>prcp_<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>prcp_<span class="dv">5</span> <span class="op">+</span><span class="st"> </span>prcp_<span class="dv">6</span> <span class="op">+</span><span class="st"> </span>prcp_<span class="dv">7</span> <span class="op">+</span><span class="st"> </span>prcp_<span class="dv">8</span> <span class="op">+</span><span class="st"> </span>prcp_<span class="dv">9</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb86-8" data-line-number="8"><span class="st">  </span>tmax_<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>tmax_<span class="dv">5</span> <span class="op">+</span><span class="st"> </span>tmax_<span class="dv">6</span> <span class="op">+</span><span class="st"> </span>tmax_<span class="dv">7</span> <span class="op">+</span><span class="st"> </span>tmax_<span class="dv">8</span> <span class="op">+</span><span class="st"> </span>tmax_<span class="dv">9</span></a>
<a class="sourceLine" id="cb86-9" data-line-number="9">  <span class="op">|</span>well_id <span class="op">+</span><span class="st"> </span>year<span class="op">|</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>well_id,</a>
<a class="sourceLine" id="cb86-10" data-line-number="10">  <span class="dt">data =</span> reg_data</a>
<a class="sourceLine" id="cb86-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb86-12" data-line-number="12"></a>
<a class="sourceLine" id="cb86-13" data-line-number="13"><span class="co">#--- display regression results ---#</span></a>
<a class="sourceLine" id="cb86-14" data-line-number="14"><span class="kw">stargazer</span>(reg_results, <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>)</a></code></pre></div>
<table style="text-align:center">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
af_used
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
prcp_4
</td>
<td>
-0.053<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.017)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
prcp_5
</td>
<td>
0.112<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.010)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
prcp_6
</td>
<td>
-0.073<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.008)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
prcp_7
</td>
<td>
0.014
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.010)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
prcp_8
</td>
<td>
0.093<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.014)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
prcp_9
</td>
<td>
-0.177<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.025)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
tmax_4
</td>
<td>
9.159<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1.227)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
tmax_5
</td>
<td>
-7.505<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1.062)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
tmax_6
</td>
<td>
15.134<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1.360)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
tmax_7
</td>
<td>
3.969<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1.618)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
tmax_8
</td>
<td>
3.420<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1.066)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
tmax_9
</td>
<td>
-11.803<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1.801)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
55,754
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.942
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.883
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
46.864 (df = 27659)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>That’s it. Do not bother to try to read into the regression results. Again, this is just an illustration of how R can be used to prepare a regression-ready dataset with spatial variables.</p>

</div>
</div>
<!-- </div> -->
<div class="footnotes">
<hr />
<ol start="30">
<li id="fn30"><p><a href="https://daymet.ornl.gov/">Daymet website</a><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#fnref30" class="footnote-back">↩</a></p></li>
<li id="fn31"><p><a href="https://cran.r-project.org/web/packages/daymetr/vignettes/daymetr-vignette.html">daymetr vignette</a><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#fnref31" class="footnote-back">↩</a></p></li>
<li id="fn32"><p>See <a href="">here</a> for a fuller explanation of how to use the <code>daymetr</code> package.<a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#fnref32" class="footnote-back">↩</a></p></li>
<li id="fn33"><p>This may not be ideal for a real research project because the original raw data is not kept. It is often the case that your econometric plan changes on the course of your project (e.g., using other weather variables or using different temporal aggregation of weather variables instead of monthly aggregation). When this happens, you need to download the same data all over again.<a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#fnref33" class="footnote-back">↩</a></p></li>
<li id="fn34"><p>For parallelized computation, see Chapter <a href="#prallel"><strong>??</strong></a><a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#fnref34" class="footnote-back">↩</a></p></li>
<li id="fn35"><p>For Mac users, <code>mclapply</code> or <code>pbmclapply</code> (<code>mclapply</code> with progress bar) are good alternatives.<a href="demonstration-5-groundwater-use-for-agricultural-irrigation.html#fnref35" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="demo4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="vector-basics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
